(function(A,te){typeof exports=="object"&&typeof module<"u"?module.exports=te(require("react"),require("react-dom")):typeof define=="function"&&define.amd?define(["react","react-dom"],te):(A=typeof globalThis<"u"?globalThis:A||self,A.VoiceAssistantWidget=te(A.React,A.ReactDOM))})(this,function(A,te){"use strict";var Th=Object.defineProperty;var hi=A=>{throw TypeError(A)};var Ch=(A,te,be)=>te in A?Th(A,te,{enumerable:!0,configurable:!0,writable:!0,value:be}):A[te]=be;var K=(A,te,be)=>Ch(A,typeof te!="symbol"?te+"":te,be),Ah=(A,te,be)=>te.has(A)||hi("Cannot "+be);var fi=(A,te,be)=>te.has(A)?hi("Cannot add the same private member more than once"):te instanceof WeakSet?te.add(A):te.set(A,be);var vr=(A,te,be)=>(Ah(A,te,"access private method"),be);var Qe,Cn,pi;function be(n){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(n){for(const t in n)if(t!=="default"){const r=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:()=>n[t]})}}return e.default=n,Object.freeze(e)}const g=be(A),mi=be(te);var ke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function vi(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function bi(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var br={exports:{}},bt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var An;function yi(){if(An)return bt;An=1;var n=A,e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function i(a,l,u){var c,h={},d=null,p=null;u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(p=l.ref);for(c in l)r.call(l,c)&&!o.hasOwnProperty(c)&&(h[c]=l[c]);if(a&&a.defaultProps)for(c in l=a.defaultProps,l)h[c]===void 0&&(h[c]=l[c]);return{$$typeof:e,type:a,key:d,ref:p,props:h,_owner:s.current}}return bt.Fragment=t,bt.jsx=i,bt.jsxs=i,bt}var yt={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pn;function wi(){return Pn||(Pn=1,process.env.NODE_ENV!=="production"&&function(){var n=A,e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),y=Symbol.iterator,m="@@iterator";function w(f){if(f===null||typeof f!="object")return null;var C=y&&f[y]||f[m];return typeof C=="function"?C:null}var S=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function b(f){{for(var C=arguments.length,R=new Array(C>1?C-1:0),M=1;M<C;M++)R[M-1]=arguments[M];k("error",f,R)}}function k(f,C,R){{var M=S.ReactDebugCurrentFrame,J=M.getStackAddendum();J!==""&&(C+="%s",R=R.concat([J]));var X=R.map(function(V){return String(V)});X.unshift("Warning: "+C),Function.prototype.apply.call(console[f],console,X)}}var x=!1,T=!1,j=!1,O=!1,N=!1,$;$=Symbol.for("react.module.reference");function B(f){return!!(typeof f=="string"||typeof f=="function"||f===r||f===o||N||f===s||f===u||f===c||O||f===p||x||T||j||typeof f=="object"&&f!==null&&(f.$$typeof===d||f.$$typeof===h||f.$$typeof===i||f.$$typeof===a||f.$$typeof===l||f.$$typeof===$||f.getModuleId!==void 0))}function Q(f,C,R){var M=f.displayName;if(M)return M;var J=C.displayName||C.name||"";return J!==""?R+"("+J+")":R}function D(f){return f.displayName||"Context"}function ce(f){if(f==null)return null;if(typeof f.tag=="number"&&b("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case r:return"Fragment";case t:return"Portal";case o:return"Profiler";case s:return"StrictMode";case u:return"Suspense";case c:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case a:var C=f;return D(C)+".Consumer";case i:var R=f;return D(R._context)+".Provider";case l:return Q(f,f.render,"ForwardRef");case h:var M=f.displayName||null;return M!==null?M:ce(f.type)||"Memo";case d:{var J=f,X=J._payload,V=J._init;try{return ce(V(X))}catch{return null}}}return null}var me=Object.assign,Oe=0,_,E,L,G,z,ne,oe;function jt(){}jt.__reactDisabledLog=!0;function Qd(){{if(Oe===0){_=console.log,E=console.info,L=console.warn,G=console.error,z=console.group,ne=console.groupCollapsed,oe=console.groupEnd;var f={configurable:!0,enumerable:!0,value:jt,writable:!0};Object.defineProperties(console,{info:f,log:f,warn:f,error:f,group:f,groupCollapsed:f,groupEnd:f})}Oe++}}function eh(){{if(Oe--,Oe===0){var f={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:me({},f,{value:_}),info:me({},f,{value:E}),warn:me({},f,{value:L}),error:me({},f,{value:G}),group:me({},f,{value:z}),groupCollapsed:me({},f,{value:ne}),groupEnd:me({},f,{value:oe})})}Oe<0&&b("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var bn=S.ReactCurrentDispatcher,yn;function fr(f,C,R){{if(yn===void 0)try{throw Error()}catch(J){var M=J.stack.trim().match(/\n( *(at )?)/);yn=M&&M[1]||""}return`
`+yn+f}}var wn=!1,pr;{var th=typeof WeakMap=="function"?WeakMap:Map;pr=new th}function Zo(f,C){if(!f||wn)return"";{var R=pr.get(f);if(R!==void 0)return R}var M;wn=!0;var J=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var X;X=bn.current,bn.current=null,Qd();try{if(C){var V=function(){throw Error()};if(Object.defineProperty(V.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(V,[])}catch(ve){M=ve}Reflect.construct(f,[],V)}else{try{V.call()}catch(ve){M=ve}f.call(V.prototype)}}else{try{throw Error()}catch(ve){M=ve}f()}}catch(ve){if(ve&&M&&typeof ve.stack=="string"){for(var q=ve.stack.split(`
`),de=M.stack.split(`
`),se=q.length-1,ie=de.length-1;se>=1&&ie>=0&&q[se]!==de[ie];)ie--;for(;se>=1&&ie>=0;se--,ie--)if(q[se]!==de[ie]){if(se!==1||ie!==1)do if(se--,ie--,ie<0||q[se]!==de[ie]){var Se=`
`+q[se].replace(" at new "," at ");return f.displayName&&Se.includes("<anonymous>")&&(Se=Se.replace("<anonymous>",f.displayName)),typeof f=="function"&&pr.set(f,Se),Se}while(se>=1&&ie>=0);break}}}finally{wn=!1,bn.current=X,eh(),Error.prepareStackTrace=J}var vt=f?f.displayName||f.name:"",et=vt?fr(vt):"";return typeof f=="function"&&pr.set(f,et),et}function rh(f,C,R){return Zo(f,!1)}function nh(f){var C=f.prototype;return!!(C&&C.isReactComponent)}function gr(f,C,R){if(f==null)return"";if(typeof f=="function")return Zo(f,nh(f));if(typeof f=="string")return fr(f);switch(f){case u:return fr("Suspense");case c:return fr("SuspenseList")}if(typeof f=="object")switch(f.$$typeof){case l:return rh(f.render);case h:return gr(f.type,C,R);case d:{var M=f,J=M._payload,X=M._init;try{return gr(X(J),C,R)}catch{}}}return""}var Ot=Object.prototype.hasOwnProperty,Qo={},ei=S.ReactDebugCurrentFrame;function mr(f){if(f){var C=f._owner,R=gr(f.type,f._source,C?C.type:null);ei.setExtraStackFrame(R)}else ei.setExtraStackFrame(null)}function sh(f,C,R,M,J){{var X=Function.call.bind(Ot);for(var V in f)if(X(f,V)){var q=void 0;try{if(typeof f[V]!="function"){var de=Error((M||"React class")+": "+R+" type `"+V+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof f[V]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw de.name="Invariant Violation",de}q=f[V](C,V,M,R,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(se){q=se}q&&!(q instanceof Error)&&(mr(J),b("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",M||"React class",R,V,typeof q),mr(null)),q instanceof Error&&!(q.message in Qo)&&(Qo[q.message]=!0,mr(J),b("Failed %s type: %s",R,q.message),mr(null))}}}var oh=Array.isArray;function _n(f){return oh(f)}function ih(f){{var C=typeof Symbol=="function"&&Symbol.toStringTag,R=C&&f[Symbol.toStringTag]||f.constructor.name||"Object";return R}}function ah(f){try{return ti(f),!1}catch{return!0}}function ti(f){return""+f}function ri(f){if(ah(f))return b("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",ih(f)),ti(f)}var It=S.ReactCurrentOwner,lh={key:!0,ref:!0,__self:!0,__source:!0},ni,si,kn;kn={};function ch(f){if(Ot.call(f,"ref")){var C=Object.getOwnPropertyDescriptor(f,"ref").get;if(C&&C.isReactWarning)return!1}return f.ref!==void 0}function uh(f){if(Ot.call(f,"key")){var C=Object.getOwnPropertyDescriptor(f,"key").get;if(C&&C.isReactWarning)return!1}return f.key!==void 0}function dh(f,C){if(typeof f.ref=="string"&&It.current&&C&&It.current.stateNode!==C){var R=ce(It.current.type);kn[R]||(b('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',ce(It.current.type),f.ref),kn[R]=!0)}}function hh(f,C){{var R=function(){ni||(ni=!0,b("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",C))};R.isReactWarning=!0,Object.defineProperty(f,"key",{get:R,configurable:!0})}}function fh(f,C){{var R=function(){si||(si=!0,b("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",C))};R.isReactWarning=!0,Object.defineProperty(f,"ref",{get:R,configurable:!0})}}var ph=function(f,C,R,M,J,X,V){var q={$$typeof:e,type:f,key:C,ref:R,props:V,_owner:X};return q._store={},Object.defineProperty(q._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(q,"_self",{configurable:!1,enumerable:!1,writable:!1,value:M}),Object.defineProperty(q,"_source",{configurable:!1,enumerable:!1,writable:!1,value:J}),Object.freeze&&(Object.freeze(q.props),Object.freeze(q)),q};function gh(f,C,R,M,J){{var X,V={},q=null,de=null;R!==void 0&&(ri(R),q=""+R),uh(C)&&(ri(C.key),q=""+C.key),ch(C)&&(de=C.ref,dh(C,J));for(X in C)Ot.call(C,X)&&!lh.hasOwnProperty(X)&&(V[X]=C[X]);if(f&&f.defaultProps){var se=f.defaultProps;for(X in se)V[X]===void 0&&(V[X]=se[X])}if(q||de){var ie=typeof f=="function"?f.displayName||f.name||"Unknown":f;q&&hh(V,ie),de&&fh(V,ie)}return ph(f,q,de,J,M,It.current,V)}}var xn=S.ReactCurrentOwner,oi=S.ReactDebugCurrentFrame;function mt(f){if(f){var C=f._owner,R=gr(f.type,f._source,C?C.type:null);oi.setExtraStackFrame(R)}else oi.setExtraStackFrame(null)}var Sn;Sn=!1;function En(f){return typeof f=="object"&&f!==null&&f.$$typeof===e}function ii(){{if(xn.current){var f=ce(xn.current.type);if(f)return`

Check the render method of \``+f+"`."}return""}}function mh(f){return""}var ai={};function vh(f){{var C=ii();if(!C){var R=typeof f=="string"?f:f.displayName||f.name;R&&(C=`

Check the top-level render call using <`+R+">.")}return C}}function li(f,C){{if(!f._store||f._store.validated||f.key!=null)return;f._store.validated=!0;var R=vh(C);if(ai[R])return;ai[R]=!0;var M="";f&&f._owner&&f._owner!==xn.current&&(M=" It was passed a child from "+ce(f._owner.type)+"."),mt(f),b('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',R,M),mt(null)}}function ci(f,C){{if(typeof f!="object")return;if(_n(f))for(var R=0;R<f.length;R++){var M=f[R];En(M)&&li(M,C)}else if(En(f))f._store&&(f._store.validated=!0);else if(f){var J=w(f);if(typeof J=="function"&&J!==f.entries)for(var X=J.call(f),V;!(V=X.next()).done;)En(V.value)&&li(V.value,C)}}}function bh(f){{var C=f.type;if(C==null||typeof C=="string")return;var R;if(typeof C=="function")R=C.propTypes;else if(typeof C=="object"&&(C.$$typeof===l||C.$$typeof===h))R=C.propTypes;else return;if(R){var M=ce(C);sh(R,f.props,"prop",M,f)}else if(C.PropTypes!==void 0&&!Sn){Sn=!0;var J=ce(C);b("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",J||"Unknown")}typeof C.getDefaultProps=="function"&&!C.getDefaultProps.isReactClassApproved&&b("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function yh(f){{for(var C=Object.keys(f.props),R=0;R<C.length;R++){var M=C[R];if(M!=="children"&&M!=="key"){mt(f),b("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",M),mt(null);break}}f.ref!==null&&(mt(f),b("Invalid attribute `ref` supplied to `React.Fragment`."),mt(null))}}var ui={};function di(f,C,R,M,J,X){{var V=B(f);if(!V){var q="";(f===void 0||typeof f=="object"&&f!==null&&Object.keys(f).length===0)&&(q+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var de=mh();de?q+=de:q+=ii();var se;f===null?se="null":_n(f)?se="array":f!==void 0&&f.$$typeof===e?(se="<"+(ce(f.type)||"Unknown")+" />",q=" Did you accidentally export a JSX literal instead of a component?"):se=typeof f,b("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",se,q)}var ie=gh(f,C,R,J,X);if(ie==null)return ie;if(V){var Se=C.children;if(Se!==void 0)if(M)if(_n(Se)){for(var vt=0;vt<Se.length;vt++)ci(Se[vt],f);Object.freeze&&Object.freeze(Se)}else b("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else ci(Se,f)}if(Ot.call(C,"key")){var et=ce(f),ve=Object.keys(C).filter(function(Eh){return Eh!=="key"}),Tn=ve.length>0?"{key: someKey, "+ve.join(": ..., ")+": ...}":"{key: someKey}";if(!ui[et+Tn]){var Sh=ve.length>0?"{"+ve.join(": ..., ")+": ...}":"{}";b(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Tn,et,Sh,et),ui[et+Tn]=!0}}return f===r?yh(ie):bh(ie),ie}}function wh(f,C,R){return di(f,C,R,!0)}function _h(f,C,R){return di(f,C,R,!1)}var kh=_h,xh=wh;yt.Fragment=r,yt.jsx=kh,yt.jsxs=xh}()),yt}process.env.NODE_ENV==="production"?br.exports=yi():br.exports=wi();var v=br.exports,yr,Lt=te;if(process.env.NODE_ENV==="production")yr=Lt.createRoot,Lt.hydrateRoot;else{var Rn=Lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;yr=function(n,e){Rn.usingClientEntryPoint=!0;try{return Lt.createRoot(n,e)}finally{Rn.usingClientEntryPoint=!1}}}function ue(n,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(n==null||n(s),t===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function _i(n,e){typeof n=="function"?n(e):n!=null&&(n.current=e)}function $n(...n){return e=>n.forEach(t=>_i(t,e))}function ye(...n){return g.useCallback($n(...n),n)}function ki(n,e){const t=g.createContext(e),r=o=>{const{children:i,...a}=o,l=g.useMemo(()=>a,Object.values(a));return v.jsx(t.Provider,{value:l,children:i})};r.displayName=n+"Provider";function s(o){const i=g.useContext(t);if(i)return i;if(e!==void 0)return e;throw new Error(`\`${o}\` must be used within \`${n}\``)}return[r,s]}function jn(n,e=[]){let t=[];function r(o,i){const a=g.createContext(i),l=t.length;t=[...t,i];const u=h=>{var S;const{scope:d,children:p,...y}=h,m=((S=d==null?void 0:d[n])==null?void 0:S[l])||a,w=g.useMemo(()=>y,Object.values(y));return v.jsx(m.Provider,{value:w,children:p})};u.displayName=o+"Provider";function c(h,d){var m;const p=((m=d==null?void 0:d[n])==null?void 0:m[l])||a,y=g.useContext(p);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${h}\` must be used within \`${o}\``)}return[u,c]}const s=()=>{const o=t.map(i=>g.createContext(i));return function(a){const l=(a==null?void 0:a[n])||o;return g.useMemo(()=>({[`__scope${n}`]:{...a,[n]:l}}),[a,l])}};return s.scopeName=n,[r,xi(s,...e)]}function xi(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const i=r.reduce((a,{useScope:l,scopeName:u})=>{const h=l(o)[`__scope${u}`];return{...a,...h}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:i}),[i])}};return t.scopeName=e.scopeName,t}var wt=globalThis!=null&&globalThis.document?g.useLayoutEffect:()=>{},Si=g.useId||(()=>{}),Ei=0;function wr(n){const[e,t]=g.useState(Si());return wt(()=>{n||t(r=>r??String(Ei++))},[n]),n||(e?`radix-${e}`:"")}function he(n){const e=g.useRef(n);return g.useEffect(()=>{e.current=n}),g.useMemo(()=>(...t)=>{var r;return(r=e.current)==null?void 0:r.call(e,...t)},[])}function Ti({prop:n,defaultProp:e,onChange:t=()=>{}}){const[r,s]=Ci({defaultProp:e,onChange:t}),o=n!==void 0,i=o?n:r,a=he(t),l=g.useCallback(u=>{if(o){const h=typeof u=="function"?u(n):u;h!==n&&a(h)}else s(u)},[o,n,s,a]);return[i,l]}function Ci({defaultProp:n,onChange:e}){const t=g.useState(n),[r]=t,s=g.useRef(r),o=he(e);return g.useEffect(()=>{s.current!==r&&(o(r),s.current=r)},[r,s,o]),t}var _r=g.forwardRef((n,e)=>{const{children:t,...r}=n,s=g.Children.toArray(t),o=s.find(Pi);if(o){const i=o.props.children,a=s.map(l=>l===o?g.Children.count(i)>1?g.Children.only(null):g.isValidElement(i)?i.props.children:null:l);return v.jsx(kr,{...r,ref:e,children:g.isValidElement(i)?g.cloneElement(i,void 0,a):null})}return v.jsx(kr,{...r,ref:e,children:t})});_r.displayName="Slot";var kr=g.forwardRef((n,e)=>{const{children:t,...r}=n;if(g.isValidElement(t)){const s=$i(t);return g.cloneElement(t,{...Ri(r,t.props),ref:e?$n(e,s):s})}return g.Children.count(t)>1?g.Children.only(null):null});kr.displayName="SlotClone";var Ai=({children:n})=>v.jsx(v.Fragment,{children:n});function Pi(n){return g.isValidElement(n)&&n.type===Ai}function Ri(n,e){const t={...e};for(const r in e){const s=n[r],o=e[r];/^on[A-Z]/.test(r)?s&&o?t[r]=(...a)=>{o(...a),s(...a)}:s&&(t[r]=s):r==="style"?t[r]={...s,...o}:r==="className"&&(t[r]=[s,o].filter(Boolean).join(" "))}return{...n,...t}}function $i(n){var r,s;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(s=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var ji=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],fe=ji.reduce((n,e)=>{const t=g.forwardRef((r,s)=>{const{asChild:o,...i}=r,a=o?_r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),v.jsx(a,{...i,ref:s})});return t.displayName=`Primitive.${e}`,{...n,[e]:t}},{});function Oi(n,e){n&&mi.flushSync(()=>n.dispatchEvent(e))}function Ii(n,e=globalThis==null?void 0:globalThis.document){const t=he(n);g.useEffect(()=>{const r=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[t,e])}var Li="DismissableLayer",xr="dismissableLayer.update",Di="dismissableLayer.pointerDownOutside",Ni="dismissableLayer.focusOutside",On,In=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ln=g.forwardRef((n,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:o,onInteractOutside:i,onDismiss:a,...l}=n,u=g.useContext(In),[c,h]=g.useState(null),d=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=g.useState({}),y=ye(e,O=>h(O)),m=Array.from(u.layers),[w]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),S=m.indexOf(w),b=c?m.indexOf(c):-1,k=u.layersWithOutsidePointerEventsDisabled.size>0,x=b>=S,T=Fi(O=>{const N=O.target,$=[...u.branches].some(B=>B.contains(N));!x||$||(s==null||s(O),i==null||i(O),O.defaultPrevented||a==null||a())},d),j=zi(O=>{const N=O.target;[...u.branches].some(B=>B.contains(N))||(o==null||o(O),i==null||i(O),O.defaultPrevented||a==null||a())},d);return Ii(O=>{b===u.layers.size-1&&(r==null||r(O),!O.defaultPrevented&&a&&(O.preventDefault(),a()))},d),g.useEffect(()=>{if(c)return t&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(On=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(c)),u.layers.add(c),Dn(),()=>{t&&u.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=On)}},[c,d,t,u]),g.useEffect(()=>()=>{c&&(u.layers.delete(c),u.layersWithOutsidePointerEventsDisabled.delete(c),Dn())},[c,u]),g.useEffect(()=>{const O=()=>p({});return document.addEventListener(xr,O),()=>document.removeEventListener(xr,O)},[]),v.jsx(fe.div,{...l,ref:y,style:{pointerEvents:k?x?"auto":"none":void 0,...n.style},onFocusCapture:ue(n.onFocusCapture,j.onFocusCapture),onBlurCapture:ue(n.onBlurCapture,j.onBlurCapture),onPointerDownCapture:ue(n.onPointerDownCapture,T.onPointerDownCapture)})});Ln.displayName=Li;var Mi="DismissableLayerBranch",Ui=g.forwardRef((n,e)=>{const t=g.useContext(In),r=g.useRef(null),s=ye(e,r);return g.useEffect(()=>{const o=r.current;if(o)return t.branches.add(o),()=>{t.branches.delete(o)}},[t.branches]),v.jsx(fe.div,{...n,ref:s})});Ui.displayName=Mi;function Fi(n,e=globalThis==null?void 0:globalThis.document){const t=he(n),r=g.useRef(!1),s=g.useRef(()=>{});return g.useEffect(()=>{const o=a=>{if(a.target&&!r.current){let l=function(){Nn(Di,t,u,{discrete:!0})};const u={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);r.current=!1},i=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),e.removeEventListener("pointerdown",o),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>r.current=!0}}function zi(n,e=globalThis==null?void 0:globalThis.document){const t=he(n),r=g.useRef(!1);return g.useEffect(()=>{const s=o=>{o.target&&!r.current&&Nn(Ni,t,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Dn(){const n=new CustomEvent(xr);document.dispatchEvent(n)}function Nn(n,e,t,{discrete:r}){const s=t.originalEvent.target,o=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(n,e,{once:!0}),r?Oi(s,o):s.dispatchEvent(o)}var Sr="focusScope.autoFocusOnMount",Er="focusScope.autoFocusOnUnmount",Mn={bubbles:!1,cancelable:!0},Bi="FocusScope",Un=g.forwardRef((n,e)=>{const{loop:t=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:o,...i}=n,[a,l]=g.useState(null),u=he(s),c=he(o),h=g.useRef(null),d=ye(e,m=>l(m)),p=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let m=function(k){if(p.paused||!a)return;const x=k.target;a.contains(x)?h.current=x:De(h.current,{select:!0})},w=function(k){if(p.paused||!a)return;const x=k.relatedTarget;x!==null&&(a.contains(x)||De(h.current,{select:!0}))},S=function(k){if(document.activeElement===document.body)for(const T of k)T.removedNodes.length>0&&De(a)};document.addEventListener("focusin",m),document.addEventListener("focusout",w);const b=new MutationObserver(S);return a&&b.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",w),b.disconnect()}}},[r,a,p.paused]),g.useEffect(()=>{if(a){Bn.add(p);const m=document.activeElement;if(!a.contains(m)){const S=new CustomEvent(Sr,Mn);a.addEventListener(Sr,u),a.dispatchEvent(S),S.defaultPrevented||(Wi(Ji(Fn(a)),{select:!0}),document.activeElement===m&&De(a))}return()=>{a.removeEventListener(Sr,u),setTimeout(()=>{const S=new CustomEvent(Er,Mn);a.addEventListener(Er,c),a.dispatchEvent(S),S.defaultPrevented||De(m??document.body,{select:!0}),a.removeEventListener(Er,c),Bn.remove(p)},0)}}},[a,u,c,p]);const y=g.useCallback(m=>{if(!t&&!r||p.paused)return;const w=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,S=document.activeElement;if(w&&S){const b=m.currentTarget,[k,x]=qi(b);k&&x?!m.shiftKey&&S===x?(m.preventDefault(),t&&De(k,{select:!0})):m.shiftKey&&S===k&&(m.preventDefault(),t&&De(x,{select:!0})):S===b&&m.preventDefault()}},[t,r,p.paused]);return v.jsx(fe.div,{tabIndex:-1,...i,ref:d,onKeyDown:y})});Un.displayName=Bi;function Wi(n,{select:e=!1}={}){const t=document.activeElement;for(const r of n)if(De(r,{select:e}),document.activeElement!==t)return}function qi(n){const e=Fn(n),t=zn(e,n),r=zn(e.reverse(),n);return[t,r]}function Fn(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function zn(n,e){for(const t of n)if(!Vi(t,{upTo:e}))return t}function Vi(n,{upTo:e}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(e!==void 0&&n===e)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function Hi(n){return n instanceof HTMLInputElement&&"select"in n}function De(n,{select:e=!1}={}){if(n&&n.focus){const t=document.activeElement;n.focus({preventScroll:!0}),n!==t&&Hi(n)&&e&&n.select()}}var Bn=Gi();function Gi(){let n=[];return{add(e){const t=n[0];e!==t&&(t==null||t.pause()),n=Wn(n,e),n.unshift(e)},remove(e){var t;n=Wn(n,e),(t=n[0])==null||t.resume()}}}function Wn(n,e){const t=[...n],r=t.indexOf(e);return r!==-1&&t.splice(r,1),t}function Ji(n){return n.filter(e=>e.tagName!=="A")}var Ki="Portal",qn=g.forwardRef((n,e)=>{var a;const{container:t,...r}=n,[s,o]=g.useState(!1);wt(()=>o(!0),[]);const i=t||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return i?te.createPortal(v.jsx(fe.div,{...r,ref:e}),i):null});qn.displayName=Ki;function Yi(n,e){return g.useReducer((t,r)=>e[t][r]??t,n)}var Ne=n=>{const{present:e,children:t}=n,r=Xi(e),s=typeof t=="function"?t({present:r.isPresent}):g.Children.only(t),o=ye(r.ref,Zi(s));return typeof t=="function"||r.isPresent?g.cloneElement(s,{ref:o}):null};Ne.displayName="Presence";function Xi(n){const[e,t]=g.useState(),r=g.useRef({}),s=g.useRef(n),o=g.useRef("none"),i=n?"mounted":"unmounted",[a,l]=Yi(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const u=Dt(r.current);o.current=a==="mounted"?u:"none"},[a]),wt(()=>{const u=r.current,c=s.current;if(c!==n){const d=o.current,p=Dt(u);n?l("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(c&&d!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=n}},[n,l]),wt(()=>{if(e){let u;const c=e.ownerDocument.defaultView??window,h=p=>{const m=Dt(r.current).includes(p.animationName);if(p.target===e&&m&&(l("ANIMATION_END"),!s.current)){const w=e.style.animationFillMode;e.style.animationFillMode="forwards",u=c.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=w)})}},d=p=>{p.target===e&&(o.current=Dt(r.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{c.clearTimeout(u),e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:g.useCallback(u=>{u&&(r.current=getComputedStyle(u)),t(u)},[])}}function Dt(n){return(n==null?void 0:n.animationName)||"none"}function Zi(n){var r,s;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(s=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var Tr=0;function Qi(){g.useEffect(()=>{const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",n[0]??Vn()),document.body.insertAdjacentElement("beforeend",n[1]??Vn()),Tr++,()=>{Tr===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Tr--}},[])}function Vn(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.outline="none",n.style.opacity="0",n.style.position="fixed",n.style.pointerEvents="none",n}var Ae=function(){return Ae=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ae.apply(this,arguments)};function Hn(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function ea(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,o;r<s;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}typeof SuppressedError=="function"&&SuppressedError;var Nt="right-scroll-bar-position",Mt="width-before-scroll-bar",ta="with-scroll-bars-hidden",ra="--removed-body-scroll-bar-size";function Cr(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function na(n,e){var t=A.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(r){var s=t.value;s!==r&&(t.value=r,t.callback(r,s))}}}})[0];return t.callback=e,t.facade}var sa=typeof window<"u"?g.useLayoutEffect:g.useEffect,Gn=new WeakMap;function oa(n,e){var t=na(null,function(r){return n.forEach(function(s){return Cr(s,r)})});return sa(function(){var r=Gn.get(t);if(r){var s=new Set(r),o=new Set(n),i=t.current;s.forEach(function(a){o.has(a)||Cr(a,null)}),o.forEach(function(a){s.has(a)||Cr(a,i)})}Gn.set(t,n)},[n]),t}function ia(n){return n}function aa(n,e){e===void 0&&(e=ia);var t=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(o){var i=e(o,r);return t.push(i),function(){t=t.filter(function(a){return a!==i})}},assignSyncMedium:function(o){for(r=!0;t.length;){var i=t;t=[],i.forEach(o)}t={push:function(a){return o(a)},filter:function(){return t}}},assignMedium:function(o){r=!0;var i=[];if(t.length){var a=t;t=[],a.forEach(o),i=t}var l=function(){var c=i;i=[],c.forEach(o)},u=function(){return Promise.resolve().then(l)};u(),t={push:function(c){i.push(c),u()},filter:function(c){return i=i.filter(c),t}}}};return s}function la(n){n===void 0&&(n={});var e=aa(null);return e.options=Ae({async:!0,ssr:!1},n),e}var Jn=function(n){var e=n.sideCar,t=Hn(n,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return g.createElement(r,Ae({},t))};Jn.isSideCarExport=!0;function ca(n,e){return n.useMedium(e),Jn}var Kn=la(),Ar=function(){},Ut=g.forwardRef(function(n,e){var t=g.useRef(null),r=g.useState({onScrollCapture:Ar,onWheelCapture:Ar,onTouchMoveCapture:Ar}),s=r[0],o=r[1],i=n.forwardProps,a=n.children,l=n.className,u=n.removeScrollBar,c=n.enabled,h=n.shards,d=n.sideCar,p=n.noIsolation,y=n.inert,m=n.allowPinchZoom,w=n.as,S=w===void 0?"div":w,b=n.gapMode,k=Hn(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=d,T=oa([t,e]),j=Ae(Ae({},k),s);return g.createElement(g.Fragment,null,c&&g.createElement(x,{sideCar:Kn,removeScrollBar:u,shards:h,noIsolation:p,inert:y,setCallbacks:o,allowPinchZoom:!!m,lockRef:t,gapMode:b}),i?g.cloneElement(g.Children.only(a),Ae(Ae({},j),{ref:T})):g.createElement(S,Ae({},j,{className:l,ref:T}),a))});Ut.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Ut.classNames={fullWidth:Mt,zeroRight:Nt};var ua=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function da(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var e=ua();return e&&n.setAttribute("nonce",e),n}function ha(n,e){n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}function fa(n){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(n)}var pa=function(){var n=0,e=null;return{add:function(t){n==0&&(e=da())&&(ha(e,t),fa(e)),n++},remove:function(){n--,!n&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},ga=function(){var n=pa();return function(e,t){g.useEffect(function(){return n.add(e),function(){n.remove()}},[e&&t])}},Yn=function(){var n=ga(),e=function(t){var r=t.styles,s=t.dynamic;return n(r,s),null};return e},ma={left:0,top:0,right:0,gap:0},Pr=function(n){return parseInt(n||"",10)||0},va=function(n){var e=window.getComputedStyle(document.body),t=e[n==="padding"?"paddingLeft":"marginLeft"],r=e[n==="padding"?"paddingTop":"marginTop"],s=e[n==="padding"?"paddingRight":"marginRight"];return[Pr(t),Pr(r),Pr(s)]},ba=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return ma;var e=va(n),t=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-t+e[2]-e[0])}},ya=Yn(),tt="data-scroll-locked",wa=function(n,e,t,r){var s=n.left,o=n.top,i=n.right,a=n.gap;return t===void 0&&(t="margin"),`
  .`.concat(ta,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(tt,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),t==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),t==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Nt,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Mt,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Nt," .").concat(Nt,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Mt," .").concat(Mt,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(tt,`] {
    `).concat(ra,": ").concat(a,`px;
  }
`)},Xn=function(){var n=parseInt(document.body.getAttribute(tt)||"0",10);return isFinite(n)?n:0},_a=function(){g.useEffect(function(){return document.body.setAttribute(tt,(Xn()+1).toString()),function(){var n=Xn()-1;n<=0?document.body.removeAttribute(tt):document.body.setAttribute(tt,n.toString())}},[])},ka=function(n){var e=n.noRelative,t=n.noImportant,r=n.gapMode,s=r===void 0?"margin":r;_a();var o=g.useMemo(function(){return ba(s)},[s]);return g.createElement(ya,{styles:wa(o,!e,s,t?"":"!important")})},Rr=!1;if(typeof window<"u")try{var Ft=Object.defineProperty({},"passive",{get:function(){return Rr=!0,!0}});window.addEventListener("test",Ft,Ft),window.removeEventListener("test",Ft,Ft)}catch{Rr=!1}var rt=Rr?{passive:!1}:!1,xa=function(n){return n.tagName==="TEXTAREA"},Zn=function(n,e){if(!(n instanceof Element))return!1;var t=window.getComputedStyle(n);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!xa(n)&&t[e]==="visible")},Sa=function(n){return Zn(n,"overflowY")},Ea=function(n){return Zn(n,"overflowX")},Qn=function(n,e){var t=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=es(n,r);if(s){var o=ts(n,r),i=o[1],a=o[2];if(i>a)return!0}r=r.parentNode}while(r&&r!==t.body);return!1},Ta=function(n){var e=n.scrollTop,t=n.scrollHeight,r=n.clientHeight;return[e,t,r]},Ca=function(n){var e=n.scrollLeft,t=n.scrollWidth,r=n.clientWidth;return[e,t,r]},es=function(n,e){return n==="v"?Sa(e):Ea(e)},ts=function(n,e){return n==="v"?Ta(e):Ca(e)},Aa=function(n,e){return n==="h"&&e==="rtl"?-1:1},Pa=function(n,e,t,r,s){var o=Aa(n,window.getComputedStyle(e).direction),i=o*r,a=t.target,l=e.contains(a),u=!1,c=i>0,h=0,d=0;do{var p=ts(n,a),y=p[0],m=p[1],w=p[2],S=m-w-o*y;(y||S)&&es(n,a)&&(h+=S,d+=y),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(c&&(Math.abs(h)<1||!s)||!c&&(Math.abs(d)<1||!s))&&(u=!0),u},zt=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},rs=function(n){return[n.deltaX,n.deltaY]},ns=function(n){return n&&"current"in n?n.current:n},Ra=function(n,e){return n[0]===e[0]&&n[1]===e[1]},$a=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},ja=0,nt=[];function Oa(n){var e=g.useRef([]),t=g.useRef([0,0]),r=g.useRef(),s=g.useState(ja++)[0],o=g.useState(Yn)[0],i=g.useRef(n);g.useEffect(function(){i.current=n},[n]),g.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(s));var m=ea([n.lockRef.current],(n.shards||[]).map(ns),!0).filter(Boolean);return m.forEach(function(w){return w.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),m.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(s))})}}},[n.inert,n.lockRef.current,n.shards]);var a=g.useCallback(function(m,w){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var S=zt(m),b=t.current,k="deltaX"in m?m.deltaX:b[0]-S[0],x="deltaY"in m?m.deltaY:b[1]-S[1],T,j=m.target,O=Math.abs(k)>Math.abs(x)?"h":"v";if("touches"in m&&O==="h"&&j.type==="range")return!1;var N=Qn(O,j);if(!N)return!0;if(N?T=O:(T=O==="v"?"h":"v",N=Qn(O,j)),!N)return!1;if(!r.current&&"changedTouches"in m&&(k||x)&&(r.current=T),!T)return!0;var $=r.current||T;return Pa($,w,m,$==="h"?k:x,!0)},[]),l=g.useCallback(function(m){var w=m;if(!(!nt.length||nt[nt.length-1]!==o)){var S="deltaY"in w?rs(w):zt(w),b=e.current.filter(function(T){return T.name===w.type&&(T.target===w.target||w.target===T.shadowParent)&&Ra(T.delta,S)})[0];if(b&&b.should){w.cancelable&&w.preventDefault();return}if(!b){var k=(i.current.shards||[]).map(ns).filter(Boolean).filter(function(T){return T.contains(w.target)}),x=k.length>0?a(w,k[0]):!i.current.noIsolation;x&&w.cancelable&&w.preventDefault()}}},[]),u=g.useCallback(function(m,w,S,b){var k={name:m,delta:w,target:S,should:b,shadowParent:Ia(S)};e.current.push(k),setTimeout(function(){e.current=e.current.filter(function(x){return x!==k})},1)},[]),c=g.useCallback(function(m){t.current=zt(m),r.current=void 0},[]),h=g.useCallback(function(m){u(m.type,rs(m),m.target,a(m,n.lockRef.current))},[]),d=g.useCallback(function(m){u(m.type,zt(m),m.target,a(m,n.lockRef.current))},[]);g.useEffect(function(){return nt.push(o),n.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:d}),document.addEventListener("wheel",l,rt),document.addEventListener("touchmove",l,rt),document.addEventListener("touchstart",c,rt),function(){nt=nt.filter(function(m){return m!==o}),document.removeEventListener("wheel",l,rt),document.removeEventListener("touchmove",l,rt),document.removeEventListener("touchstart",c,rt)}},[]);var p=n.removeScrollBar,y=n.inert;return g.createElement(g.Fragment,null,y?g.createElement(o,{styles:$a(s)}):null,p?g.createElement(ka,{gapMode:n.gapMode}):null)}function Ia(n){for(var e=null;n!==null;)n instanceof ShadowRoot&&(e=n.host,n=n.host),n=n.parentNode;return e}const La=ca(Kn,Oa);var ss=g.forwardRef(function(n,e){return g.createElement(Ut,Ae({},n,{ref:e,sideCar:La}))});ss.classNames=Ut.classNames;var Da=function(n){if(typeof document>"u")return null;var e=Array.isArray(n)?n[0]:n;return e.ownerDocument.body},st=new WeakMap,Bt=new WeakMap,Wt={},$r=0,os=function(n){return n&&(n.host||os(n.parentNode))},Na=function(n,e){return e.map(function(t){if(n.contains(t))return t;var r=os(t);return r&&n.contains(r)?r:(console.error("aria-hidden",t,"in not contained inside",n,". Doing nothing"),null)}).filter(function(t){return!!t})},Ma=function(n,e,t,r){var s=Na(e,Array.isArray(n)?n:[n]);Wt[t]||(Wt[t]=new WeakMap);var o=Wt[t],i=[],a=new Set,l=new Set(s),u=function(h){!h||a.has(h)||(a.add(h),u(h.parentNode))};s.forEach(u);var c=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(d){if(a.has(d))c(d);else try{var p=d.getAttribute(r),y=p!==null&&p!=="false",m=(st.get(d)||0)+1,w=(o.get(d)||0)+1;st.set(d,m),o.set(d,w),i.push(d),m===1&&y&&Bt.set(d,!0),w===1&&d.setAttribute(t,"true"),y||d.setAttribute(r,"true")}catch(S){console.error("aria-hidden: cannot operate on ",d,S)}})};return c(e),a.clear(),$r++,function(){i.forEach(function(h){var d=st.get(h)-1,p=o.get(h)-1;st.set(h,d),o.set(h,p),d||(Bt.has(h)||h.removeAttribute(r),Bt.delete(h)),p||h.removeAttribute(t)}),$r--,$r||(st=new WeakMap,st=new WeakMap,Bt=new WeakMap,Wt={})}},Ua=function(n,e,t){t===void 0&&(t="data-aria-hidden");var r=Array.from(Array.isArray(n)?n:[n]),s=Da(n);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),Ma(r,s,t,"aria-hidden")):function(){return null}},jr="Dialog",[is,Ph]=jn(jr),[Fa,Ee]=is(jr),as=n=>{const{__scopeDialog:e,children:t,open:r,defaultOpen:s,onOpenChange:o,modal:i=!0}=n,a=g.useRef(null),l=g.useRef(null),[u=!1,c]=Ti({prop:r,defaultProp:s,onChange:o});return v.jsx(Fa,{scope:e,triggerRef:a,contentRef:l,contentId:wr(),titleId:wr(),descriptionId:wr(),open:u,onOpenChange:c,onOpenToggle:g.useCallback(()=>c(h=>!h),[c]),modal:i,children:t})};as.displayName=jr;var ls="DialogTrigger",cs=g.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Ee(ls,t),o=ye(e,s.triggerRef);return v.jsx(fe.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":Lr(s.open),...r,ref:o,onClick:ue(n.onClick,s.onOpenToggle)})});cs.displayName=ls;var Or="DialogPortal",[za,us]=is(Or,{forceMount:void 0}),ds=n=>{const{__scopeDialog:e,forceMount:t,children:r,container:s}=n,o=Ee(Or,e);return v.jsx(za,{scope:e,forceMount:t,children:g.Children.map(r,i=>v.jsx(Ne,{present:t||o.open,children:v.jsx(qn,{asChild:!0,container:s,children:i})}))})};ds.displayName=Or;var qt="DialogOverlay",hs=g.forwardRef((n,e)=>{const t=us(qt,n.__scopeDialog),{forceMount:r=t.forceMount,...s}=n,o=Ee(qt,n.__scopeDialog);return o.modal?v.jsx(Ne,{present:r||o.open,children:v.jsx(Ba,{...s,ref:e})}):null});hs.displayName=qt;var Ba=g.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Ee(qt,t);return v.jsx(ss,{as:_r,allowPinchZoom:!0,shards:[s.contentRef],children:v.jsx(fe.div,{"data-state":Lr(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),He="DialogContent",fs=g.forwardRef((n,e)=>{const t=us(He,n.__scopeDialog),{forceMount:r=t.forceMount,...s}=n,o=Ee(He,n.__scopeDialog);return v.jsx(Ne,{present:r||o.open,children:o.modal?v.jsx(Wa,{...s,ref:e}):v.jsx(qa,{...s,ref:e})})});fs.displayName=He;var Wa=g.forwardRef((n,e)=>{const t=Ee(He,n.__scopeDialog),r=g.useRef(null),s=ye(e,t.contentRef,r);return g.useEffect(()=>{const o=r.current;if(o)return Ua(o)},[]),v.jsx(ps,{...n,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ue(n.onCloseAutoFocus,o=>{var i;o.preventDefault(),(i=t.triggerRef.current)==null||i.focus()}),onPointerDownOutside:ue(n.onPointerDownOutside,o=>{const i=o.detail.originalEvent,a=i.button===0&&i.ctrlKey===!0;(i.button===2||a)&&o.preventDefault()}),onFocusOutside:ue(n.onFocusOutside,o=>o.preventDefault())})}),qa=g.forwardRef((n,e)=>{const t=Ee(He,n.__scopeDialog),r=g.useRef(!1),s=g.useRef(!1);return v.jsx(ps,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,a;(i=n.onCloseAutoFocus)==null||i.call(n,o),o.defaultPrevented||(r.current||(a=t.triggerRef.current)==null||a.focus(),o.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:o=>{var l,u;(l=n.onInteractOutside)==null||l.call(n,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const i=o.target;((u=t.triggerRef.current)==null?void 0:u.contains(i))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&s.current&&o.preventDefault()}})}),ps=g.forwardRef((n,e)=>{const{__scopeDialog:t,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:o,...i}=n,a=Ee(He,t),l=g.useRef(null),u=ye(e,l);return Qi(),v.jsxs(v.Fragment,{children:[v.jsx(Un,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:o,children:v.jsx(Ln,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":Lr(a.open),...i,ref:u,onDismiss:()=>a.onOpenChange(!1)})}),v.jsxs(v.Fragment,{children:[v.jsx(Va,{titleId:a.titleId}),v.jsx(Ga,{contentRef:l,descriptionId:a.descriptionId})]})]})}),Ir="DialogTitle",gs=g.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Ee(Ir,t);return v.jsx(fe.h2,{id:s.titleId,...r,ref:e})});gs.displayName=Ir;var ms="DialogDescription",vs=g.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Ee(ms,t);return v.jsx(fe.p,{id:s.descriptionId,...r,ref:e})});vs.displayName=ms;var bs="DialogClose",ys=g.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Ee(bs,t);return v.jsx(fe.button,{type:"button",...r,ref:e,onClick:ue(n.onClick,()=>s.onOpenChange(!1))})});ys.displayName=bs;function Lr(n){return n?"open":"closed"}var ws="DialogTitleWarning",[Rh,_s]=ki(ws,{contentName:He,titleName:Ir,docsSlug:"dialog"}),Va=({titleId:n})=>{const e=_s(ws),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return g.useEffect(()=>{n&&(document.getElementById(n)||console.error(t))},[t,n]),null},Ha="DialogDescriptionWarning",Ga=({contentRef:n,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${_s(Ha).contentName}}.`;return g.useEffect(()=>{var o;const s=(o=n.current)==null?void 0:o.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,n,e]),null},Ja=as,Ka=cs,Ya=ds,ks=hs,xs=fs,Ss=gs,Es=vs,Xa=ys;/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ts=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Qa={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=A.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:o,iconNode:i,...a},l)=>A.createElement("svg",{ref:l,...Qa,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:Ts("lucide",s),...a},[...i.map(([u,c])=>A.createElement(u,c)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=(n,e)=>{const t=A.forwardRef(({className:r,...s},o)=>A.createElement(el,{ref:o,iconNode:e,className:Ts(`lucide-${Za(n)}`,r),...s}));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=Vt("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=Vt("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=Vt("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=Vt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Cs(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=Cs(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function ol(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=Cs(n))&&(r&&(r+=" "),r+=e);return r}const Dr="-",il=n=>{const e=ll(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=n;return{getClassGroupId:i=>{const a=i.split(Dr);return a[0]===""&&a.length!==1&&a.shift(),As(a,e)||al(i)},getConflictingClassGroupIds:(i,a)=>{const l=t[i]||[];return a&&r[i]?[...l,...r[i]]:l}}},As=(n,e)=>{var i;if(n.length===0)return e.classGroupId;const t=n[0],r=e.nextPart.get(t),s=r?As(n.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const o=n.join(Dr);return(i=e.validators.find(({validator:a})=>a(o)))==null?void 0:i.classGroupId},Ps=/^\[(.+)\]$/,al=n=>{if(Ps.test(n)){const e=Ps.exec(n)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},ll=n=>{const{theme:e,prefix:t}=n,r={nextPart:new Map,validators:[]};return ul(Object.entries(n.classGroups),t).forEach(([o,i])=>{Nr(i,r,o,e)}),r},Nr=(n,e,t,r)=>{n.forEach(s=>{if(typeof s=="string"){const o=s===""?e:Rs(e,s);o.classGroupId=t;return}if(typeof s=="function"){if(cl(s)){Nr(s(r),e,t,r);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([o,i])=>{Nr(i,Rs(e,o),t,r)})})},Rs=(n,e)=>{let t=n;return e.split(Dr).forEach(r=>{t.nextPart.has(r)||t.nextPart.set(r,{nextPart:new Map,validators:[]}),t=t.nextPart.get(r)}),t},cl=n=>n.isThemeGetter,ul=(n,e)=>e?n.map(([t,r])=>{const s=r.map(o=>typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([i,a])=>[e+i,a])):o);return[t,s]}):n,dl=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,r=new Map;const s=(o,i)=>{t.set(o,i),e++,e>n&&(e=0,r=t,t=new Map)};return{get(o){let i=t.get(o);if(i!==void 0)return i;if((i=r.get(o))!==void 0)return s(o,i),i},set(o,i){t.has(o)?t.set(o,i):s(o,i)}}},$s="!",hl=n=>{const{separator:e,experimentalParseClassName:t}=n,r=e.length===1,s=e[0],o=e.length,i=a=>{const l=[];let u=0,c=0,h;for(let w=0;w<a.length;w++){let S=a[w];if(u===0){if(S===s&&(r||a.slice(w,w+o)===e)){l.push(a.slice(c,w)),c=w+o;continue}if(S==="/"){h=w;continue}}S==="["?u++:S==="]"&&u--}const d=l.length===0?a:a.substring(c),p=d.startsWith($s),y=p?d.substring(1):d,m=h&&h>c?h-c:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:y,maybePostfixModifierPosition:m}};return t?a=>t({className:a,parseClassName:i}):i},fl=n=>{if(n.length<=1)return n;const e=[];let t=[];return n.forEach(r=>{r[0]==="["?(e.push(...t.sort(),r),t=[]):t.push(r)}),e.push(...t.sort()),e},pl=n=>({cache:dl(n.cacheSize),parseClassName:hl(n),...il(n)}),gl=/\s+/,ml=(n,e)=>{const{parseClassName:t,getClassGroupId:r,getConflictingClassGroupIds:s}=e,o=[],i=n.trim().split(gl);let a="";for(let l=i.length-1;l>=0;l-=1){const u=i[l],{modifiers:c,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:p}=t(u);let y=!!p,m=r(y?d.substring(0,p):d);if(!m){if(!y){a=u+(a.length>0?" "+a:a);continue}if(m=r(d),!m){a=u+(a.length>0?" "+a:a);continue}y=!1}const w=fl(c).join(":"),S=h?w+$s:w,b=S+m;if(o.includes(b))continue;o.push(b);const k=s(m,y);for(let x=0;x<k.length;++x){const T=k[x];o.push(S+T)}a=u+(a.length>0?" "+a:a)}return a};function vl(){let n=0,e,t,r="";for(;n<arguments.length;)(e=arguments[n++])&&(t=js(e))&&(r&&(r+=" "),r+=t);return r}const js=n=>{if(typeof n=="string")return n;let e,t="";for(let r=0;r<n.length;r++)n[r]&&(e=js(n[r]))&&(t&&(t+=" "),t+=e);return t};function bl(n,...e){let t,r,s,o=i;function i(l){const u=e.reduce((c,h)=>h(c),n());return t=pl(u),r=t.cache.get,s=t.cache.set,o=a,a(l)}function a(l){const u=r(l);if(u)return u;const c=ml(l,t);return s(l,c),c}return function(){return o(vl.apply(null,arguments))}}const ee=n=>{const e=t=>t[n]||[];return e.isThemeGetter=!0,e},Os=/^\[(?:([a-z-]+):)?(.+)\]$/i,yl=/^\d+\/\d+$/,wl=new Set(["px","full","screen"]),_l=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,kl=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,xl=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Sl=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,El=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ie=n=>ot(n)||wl.has(n)||yl.test(n),Me=n=>it(n,"length",Ol),ot=n=>!!n&&!Number.isNaN(Number(n)),Mr=n=>it(n,"number",ot),_t=n=>!!n&&Number.isInteger(Number(n)),Tl=n=>n.endsWith("%")&&ot(n.slice(0,-1)),U=n=>Os.test(n),Ue=n=>_l.test(n),Cl=new Set(["length","size","percentage"]),Al=n=>it(n,Cl,Is),Pl=n=>it(n,"position",Is),Rl=new Set(["image","url"]),$l=n=>it(n,Rl,Ll),jl=n=>it(n,"",Il),kt=()=>!0,it=(n,e,t)=>{const r=Os.exec(n);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):t(r[2]):!1},Ol=n=>kl.test(n)&&!xl.test(n),Is=()=>!1,Il=n=>Sl.test(n),Ll=n=>El.test(n),Dl=bl(()=>{const n=ee("colors"),e=ee("spacing"),t=ee("blur"),r=ee("brightness"),s=ee("borderColor"),o=ee("borderRadius"),i=ee("borderSpacing"),a=ee("borderWidth"),l=ee("contrast"),u=ee("grayscale"),c=ee("hueRotate"),h=ee("invert"),d=ee("gap"),p=ee("gradientColorStops"),y=ee("gradientColorStopPositions"),m=ee("inset"),w=ee("margin"),S=ee("opacity"),b=ee("padding"),k=ee("saturate"),x=ee("scale"),T=ee("sepia"),j=ee("skew"),O=ee("space"),N=ee("translate"),$=()=>["auto","contain","none"],B=()=>["auto","hidden","clip","visible","scroll"],Q=()=>["auto",U,e],D=()=>[U,e],ce=()=>["",Ie,Me],me=()=>["auto",ot,U],Oe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],_=()=>["solid","dashed","dotted","double","none"],E=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],L=()=>["start","end","center","between","around","evenly","stretch"],G=()=>["","0",U],z=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ne=()=>[ot,U];return{cacheSize:500,separator:":",theme:{colors:[kt],spacing:[Ie,Me],blur:["none","",Ue,U],brightness:ne(),borderColor:[n],borderRadius:["none","","full",Ue,U],borderSpacing:D(),borderWidth:ce(),contrast:ne(),grayscale:G(),hueRotate:ne(),invert:G(),gap:D(),gradientColorStops:[n],gradientColorStopPositions:[Tl,Me],inset:Q(),margin:Q(),opacity:ne(),padding:D(),saturate:ne(),scale:ne(),sepia:G(),skew:ne(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",U]}],container:["container"],columns:[{columns:[Ue]}],"break-after":[{"break-after":z()}],"break-before":[{"break-before":z()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Oe(),U]}],overflow:[{overflow:B()}],"overflow-x":[{"overflow-x":B()}],"overflow-y":[{"overflow-y":B()}],overscroll:[{overscroll:$()}],"overscroll-x":[{"overscroll-x":$()}],"overscroll-y":[{"overscroll-y":$()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",_t,U]}],basis:[{basis:Q()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",U]}],grow:[{grow:G()}],shrink:[{shrink:G()}],order:[{order:["first","last","none",_t,U]}],"grid-cols":[{"grid-cols":[kt]}],"col-start-end":[{col:["auto",{span:["full",_t,U]},U]}],"col-start":[{"col-start":me()}],"col-end":[{"col-end":me()}],"grid-rows":[{"grid-rows":[kt]}],"row-start-end":[{row:["auto",{span:[_t,U]},U]}],"row-start":[{"row-start":me()}],"row-end":[{"row-end":me()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",U]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",U]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal",...L()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...L(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...L(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[w]}],mx:[{mx:[w]}],my:[{my:[w]}],ms:[{ms:[w]}],me:[{me:[w]}],mt:[{mt:[w]}],mr:[{mr:[w]}],mb:[{mb:[w]}],ml:[{ml:[w]}],"space-x":[{"space-x":[O]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[O]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",U,e]}],"min-w":[{"min-w":[U,e,"min","max","fit"]}],"max-w":[{"max-w":[U,e,"none","full","min","max","fit","prose",{screen:[Ue]},Ue]}],h:[{h:[U,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[U,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[U,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[U,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Ue,Me]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Mr]}],"font-family":[{font:[kt]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",U]}],"line-clamp":[{"line-clamp":["none",ot,Mr]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ie,U]}],"list-image":[{"list-image":["none",U]}],"list-style-type":[{list:["none","disc","decimal",U]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[S]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[S]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[..._(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ie,Me]}],"underline-offset":[{"underline-offset":["auto",Ie,U]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",U]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",U]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[S]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Oe(),Pl]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Al]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},$l]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[y]}],"gradient-via-pos":[{via:[y]}],"gradient-to-pos":[{to:[y]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[S]}],"border-style":[{border:[..._(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[S]}],"divide-style":[{divide:_()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",..._()]}],"outline-offset":[{"outline-offset":[Ie,U]}],"outline-w":[{outline:[Ie,Me]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:ce()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[S]}],"ring-offset-w":[{"ring-offset":[Ie,Me]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",Ue,jl]}],"shadow-color":[{shadow:[kt]}],opacity:[{opacity:[S]}],"mix-blend":[{"mix-blend":[...E(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":E()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ue,U]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[h]}],saturate:[{saturate:[k]}],sepia:[{sepia:[T]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[S]}],"backdrop-saturate":[{"backdrop-saturate":[k]}],"backdrop-sepia":[{"backdrop-sepia":[T]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",U]}],duration:[{duration:ne()}],ease:[{ease:["linear","in","out","in-out",U]}],delay:[{delay:ne()}],animate:[{animate:["none","spin","ping","pulse","bounce",U]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[x]}],"scale-x":[{"scale-x":[x]}],"scale-y":[{"scale-y":[x]}],rotate:[{rotate:[_t,U]}],"translate-x":[{"translate-x":[N]}],"translate-y":[{"translate-y":[N]}],"skew-x":[{"skew-x":[j]}],"skew-y":[{"skew-y":[j]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",U]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",U]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",U]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[Ie,Me,Mr]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}});function Fe(...n){return Dl(ol(n))}const Nl=Ja,Ml=Ka,Ul=Ya,Ls=g.forwardRef(({className:n,...e},t)=>v.jsx(ks,{ref:t,className:Fe("fixed inset-0 z-50 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...e}));Ls.displayName=ks.displayName;const Ds=g.forwardRef(({className:n,children:e,...t},r)=>v.jsxs(Ul,{children:[v.jsx(Ls,{}),v.jsxs(xs,{ref:r,className:Fe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n),...t,children:[e,v.jsxs(Xa,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[v.jsx(sl,{className:"h-4 w-4"}),v.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ds.displayName=xs.displayName;const Fl=g.forwardRef(({className:n,...e},t)=>v.jsx(Ss,{ref:t,className:Fe("text-lg font-semibold leading-none tracking-tight",n),...e}));Fl.displayName=Ss.displayName;const zl=g.forwardRef(({className:n,...e},t)=>v.jsx(Es,{ref:t,className:Fe("text-sm text-muted-foreground",n),...e}));zl.displayName=Es.displayName;const Ns=A.forwardRef((n,e)=>v.jsx("button",{ref:e,className:"fixed bottom-6 right-6 h-12 w-12 rounded-full bg-gradient-to-t from-blue-500 to-blue-300 shadow-lg flex items-center justify-center z-50 transition-transform hover:scale-105",onClick:n.onClick,children:v.jsx("div",{className:"h-4 w-4 bg-white opacity-40 rounded-full"})}));Ns.displayName="VoiceDialogTrigger";var Ms=["light","dark"],Bl="(prefers-color-scheme: dark)";g.createContext(void 0),g.memo(({forcedTheme:n,storageKey:e,attribute:t,enableSystem:r,enableColorScheme:s,defaultTheme:o,value:i,attrs:a,nonce:l})=>{let u=o==="system",c=t==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(y=>`'${y}'`).join(",")})`};`:`var d=document.documentElement,n='${t}',s='setAttribute';`,h=s?Ms.includes(o)&&o?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${o}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",d=(y,m=!1,w=!0)=>{let S=i?i[y]:y,b=m?y+"|| ''":`'${S}'`,k="";return s&&w&&!m&&Ms.includes(y)&&(k+=`d.style.colorScheme = '${y}';`),t==="class"?m||S?k+=`c.add(${b})`:k+="null":S&&(k+=`d[s](n,${b})`),k},p=n?`!function(){${c}${d(n)}}()`:r?`!function(){try{${c}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${u})){var t='${Bl}',m=window.matchMedia(t);if(m.media!==t||m.matches){${d("dark")}}else{${d("light")}}}else if(e){${i?`var x=${JSON.stringify(i)};`:""}${d(i?"x[e]":"e",!0)}}${u?"":"else{"+d(o,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${c}var e=localStorage.getItem('${e}');if(e){${i?`var x=${JSON.stringify(i)};`:""}${d(i?"x[e]":"e",!0)}}else{${d(o,!1,!1)};}${h}}catch(t){}}();`;return g.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:p}})}),Array(12).fill(0),A.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},A.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),A.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},A.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),A.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},A.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),A.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},A.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"}));var Ur=1,Wl=class{constructor(){this.subscribe=n=>(this.subscribers.push(n),()=>{let e=this.subscribers.indexOf(n);this.subscribers.splice(e,1)}),this.publish=n=>{this.subscribers.forEach(e=>e(n))},this.addToast=n=>{this.publish(n),this.toasts=[...this.toasts,n]},this.create=n=>{var e;let{message:t,...r}=n,s=typeof(n==null?void 0:n.id)=="number"||((e=n.id)==null?void 0:e.length)>0?n.id:Ur++,o=this.toasts.find(a=>a.id===s),i=n.dismissible===void 0?!0:n.dismissible;return o?this.toasts=this.toasts.map(a=>a.id===s?(this.publish({...a,...n,id:s,title:t}),{...a,...n,id:s,dismissible:i,title:t}):a):this.addToast({title:t,...r,dismissible:i,id:s}),s},this.dismiss=n=>(n||this.toasts.forEach(e=>{this.subscribers.forEach(t=>t({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:n,dismiss:!0})),n),this.message=(n,e)=>this.create({...e,message:n}),this.error=(n,e)=>this.create({...e,message:n,type:"error"}),this.success=(n,e)=>this.create({...e,type:"success",message:n}),this.info=(n,e)=>this.create({...e,type:"info",message:n}),this.warning=(n,e)=>this.create({...e,type:"warning",message:n}),this.loading=(n,e)=>this.create({...e,type:"loading",message:n}),this.promise=(n,e)=>{if(!e)return;let t;e.loading!==void 0&&(t=this.create({...e,promise:n,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let r=n instanceof Promise?n:n(),s=t!==void 0;return r.then(async o=>{if(Vl(o)&&!o.ok){s=!1;let i=typeof e.error=="function"?await e.error(`HTTP error! status: ${o.status}`):e.error,a=typeof e.description=="function"?await e.description(`HTTP error! status: ${o.status}`):e.description;this.create({id:t,type:"error",message:i,description:a})}else if(e.success!==void 0){s=!1;let i=typeof e.success=="function"?await e.success(o):e.success,a=typeof e.description=="function"?await e.description(o):e.description;this.create({id:t,type:"success",message:i,description:a})}}).catch(async o=>{if(e.error!==void 0){s=!1;let i=typeof e.error=="function"?await e.error(o):e.error,a=typeof e.description=="function"?await e.description(o):e.description;this.create({id:t,type:"error",message:i,description:a})}}).finally(()=>{var o;s&&(this.dismiss(t),t=void 0),(o=e.finally)==null||o.call(e)}),t},this.custom=(n,e)=>{let t=(e==null?void 0:e.id)||Ur++;return this.create({jsx:n(t),id:t,...e}),t},this.subscribers=[],this.toasts=[]}},Te=new Wl,ql=(n,e)=>{let t=(e==null?void 0:e.id)||Ur++;return Te.addToast({title:n,...e,id:t}),t},Vl=n=>n&&typeof n=="object"&&"ok"in n&&typeof n.ok=="boolean"&&"status"in n&&typeof n.status=="number",Hl=ql,Gl=()=>Te.toasts,re=Object.assign(Hl,{success:Te.success,info:Te.info,warning:Te.warning,error:Te.error,custom:Te.custom,message:Te.message,promise:Te.promise,dismiss:Te.dismiss,loading:Te.loading},{getHistory:Gl});function Jl(n,{insertAt:e}={}){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n))}Jl(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);const Kl=({isListening:n,isSpeaking:e,voiceVolume:t,onClick:r})=>{const[s,o]=A.useState(""),[i,a]=A.useState("opacity-30");A.useEffect(()=>{let p;return e?(o("animate-pulse-wave"),a("opacity-70")):p=setTimeout(()=>{o(""),a("opacity-30")},500),()=>{p&&clearTimeout(p)}},[e]);const l=()=>{if(!e)return 1;const p=1,y=t*.04;return p+y},c=(()=>{if(e){if(t>7)return"animate-wave-high";if(t>3)return"animate-wave"}return"animate-wave-low"})(),h=l(),d=async()=>{try{r()}catch(p){console.error("Ошибка при активации голосового ассистента:",p),re.error("Не удалось активировать голосовой ассистент")}};return v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:`absolute inset-0 scale-150 rounded-full blur-xl transition-opacity duration-700 ${i}`,children:v.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-radial from-blue-400 via-blue-300 to-transparent opacity-80 animate-pulse",style:{animationDuration:"4s"}})}),v.jsxs("div",{className:"relative h-16 w-16 rounded-full bg-gradient-to-t from-blue-500 to-blue-200 shadow-lg cursor-pointer transition-all duration-200 ease-in-out",onClick:d,style:{transform:`scale(${h})`},children:[v.jsx("div",{className:"absolute inset-0 opacity-90 rounded-full overflow-hidden",children:v.jsxs("div",{className:"absolute bottom-0 left-0 right-0 h-1/2 bg-opacity-20",children:[v.jsx("div",{className:`absolute bottom-0 left-0 w-full h-5 bg-white opacity-20 rounded-full transform -translate-y-2 ${c}`}),v.jsx("div",{className:`absolute bottom-0 left-0 w-full h-4 bg-white opacity-30 rounded-full transform -translate-y-1 translate-x-2 ${c}`}),v.jsx("div",{className:`absolute bottom-0 left-0 w-full h-3 bg-white opacity-40 rounded-full transform ${c}`})]})}),e&&v.jsx("div",{className:"absolute -inset-4 rounded-full blur-md bg-gradient-to-r from-blue-400/40 via-blue-300/30 to-blue-200/20 animate-pulse",style:{animationDuration:"2s"}}),n&&v.jsx("div",{className:"absolute -top-1 -right-1 h-3 w-3 rounded-full bg-red-500 animate-pulse"})]})]})},Yl=({isListening:n,isSpeaking:e})=>{const t=()=>e?"Ассистент говорит...":n?"Ассистент слушает...":"Нажмите на круг для активации ассистента";return v.jsx("div",{className:"w-full text-center mb-4",children:v.jsx("h2",{className:"text-xl font-medium text-gray-100 h-8 flex items-center justify-center transition-all duration-300",children:t()})})};var Xl=g.createContext(void 0);function Zl(n){const e=g.useContext(Xl);return n||e||"ltr"}function Ql(n,[e,t]){return Math.min(t,Math.max(e,n))}function ec(n,e){return g.useReducer((t,r)=>e[t][r]??t,n)}var Fr="ScrollArea",[Us,jh]=jn(Fr),[tc,xe]=Us(Fr),Fs=g.forwardRef((n,e)=>{const{__scopeScrollArea:t,type:r="hover",dir:s,scrollHideDelay:o=600,...i}=n,[a,l]=g.useState(null),[u,c]=g.useState(null),[h,d]=g.useState(null),[p,y]=g.useState(null),[m,w]=g.useState(null),[S,b]=g.useState(0),[k,x]=g.useState(0),[T,j]=g.useState(!1),[O,N]=g.useState(!1),$=ye(e,Q=>l(Q)),B=Zl(s);return v.jsx(tc,{scope:t,type:r,dir:B,scrollHideDelay:o,scrollArea:a,viewport:u,onViewportChange:c,content:h,onContentChange:d,scrollbarX:p,onScrollbarXChange:y,scrollbarXEnabled:T,onScrollbarXEnabledChange:j,scrollbarY:m,onScrollbarYChange:w,scrollbarYEnabled:O,onScrollbarYEnabledChange:N,onCornerWidthChange:b,onCornerHeightChange:x,children:v.jsx(fe.div,{dir:B,...i,ref:$,style:{position:"relative","--radix-scroll-area-corner-width":S+"px","--radix-scroll-area-corner-height":k+"px",...n.style}})})});Fs.displayName=Fr;var zs="ScrollAreaViewport",Bs=g.forwardRef((n,e)=>{const{__scopeScrollArea:t,children:r,asChild:s,nonce:o,...i}=n,a=xe(zs,t),l=g.useRef(null),u=ye(e,l,a.onViewportChange);return v.jsxs(v.Fragment,{children:[v.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:o}),v.jsx(fe.div,{"data-radix-scroll-area-viewport":"",...i,asChild:s,ref:u,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...n.style},children:dc({asChild:s,children:r},c=>v.jsx("div",{"data-radix-scroll-area-content":"",ref:a.onContentChange,style:{minWidth:a.scrollbarXEnabled?"fit-content":void 0},children:c}))})]})});Bs.displayName=zs;var Pe="ScrollAreaScrollbar",zr=g.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=xe(Pe,n.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:i}=s,a=n.orientation==="horizontal";return g.useEffect(()=>(a?o(!0):i(!0),()=>{a?o(!1):i(!1)}),[a,o,i]),s.type==="hover"?v.jsx(rc,{...r,ref:e,forceMount:t}):s.type==="scroll"?v.jsx(nc,{...r,ref:e,forceMount:t}):s.type==="auto"?v.jsx(Ws,{...r,ref:e,forceMount:t}):s.type==="always"?v.jsx(Br,{...r,ref:e}):null});zr.displayName=Pe;var rc=g.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=xe(Pe,n.__scopeScrollArea),[o,i]=g.useState(!1);return g.useEffect(()=>{const a=s.scrollArea;let l=0;if(a){const u=()=>{window.clearTimeout(l),i(!0)},c=()=>{l=window.setTimeout(()=>i(!1),s.scrollHideDelay)};return a.addEventListener("pointerenter",u),a.addEventListener("pointerleave",c),()=>{window.clearTimeout(l),a.removeEventListener("pointerenter",u),a.removeEventListener("pointerleave",c)}}},[s.scrollArea,s.scrollHideDelay]),v.jsx(Ne,{present:t||o,children:v.jsx(Ws,{"data-state":o?"visible":"hidden",...r,ref:e})})}),nc=g.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=xe(Pe,n.__scopeScrollArea),o=n.orientation==="horizontal",i=Kt(()=>l("SCROLL_END"),100),[a,l]=ec("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return g.useEffect(()=>{if(a==="idle"){const u=window.setTimeout(()=>l("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(u)}},[a,s.scrollHideDelay,l]),g.useEffect(()=>{const u=s.viewport,c=o?"scrollLeft":"scrollTop";if(u){let h=u[c];const d=()=>{const p=u[c];h!==p&&(l("SCROLL"),i()),h=p};return u.addEventListener("scroll",d),()=>u.removeEventListener("scroll",d)}},[s.viewport,o,l,i]),v.jsx(Ne,{present:t||a!=="hidden",children:v.jsx(Br,{"data-state":a==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:ue(n.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:ue(n.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),Ws=g.forwardRef((n,e)=>{const t=xe(Pe,n.__scopeScrollArea),{forceMount:r,...s}=n,[o,i]=g.useState(!1),a=n.orientation==="horizontal",l=Kt(()=>{if(t.viewport){const u=t.viewport.offsetWidth<t.viewport.scrollWidth,c=t.viewport.offsetHeight<t.viewport.scrollHeight;i(a?u:c)}},10);return at(t.viewport,l),at(t.content,l),v.jsx(Ne,{present:r||o,children:v.jsx(Br,{"data-state":o?"visible":"hidden",...s,ref:e})})}),Br=g.forwardRef((n,e)=>{const{orientation:t="vertical",...r}=n,s=xe(Pe,n.__scopeScrollArea),o=g.useRef(null),i=g.useRef(0),[a,l]=g.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=Js(a.viewport,a.content),c={...r,sizes:a,onSizesChange:l,hasThumb:u>0&&u<1,onThumbChange:d=>o.current=d,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:d=>i.current=d};function h(d,p){return cc(d,i.current,a,p)}return t==="horizontal"?v.jsx(sc,{...c,ref:e,onThumbPositionChange:()=>{if(s.viewport&&o.current){const d=s.viewport.scrollLeft,p=Ks(d,a,s.dir);o.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:d=>{s.viewport&&(s.viewport.scrollLeft=d)},onDragScroll:d=>{s.viewport&&(s.viewport.scrollLeft=h(d,s.dir))}}):t==="vertical"?v.jsx(oc,{...c,ref:e,onThumbPositionChange:()=>{if(s.viewport&&o.current){const d=s.viewport.scrollTop,p=Ks(d,a);o.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:d=>{s.viewport&&(s.viewport.scrollTop=d)},onDragScroll:d=>{s.viewport&&(s.viewport.scrollTop=h(d))}}):null}),sc=g.forwardRef((n,e)=>{const{sizes:t,onSizesChange:r,...s}=n,o=xe(Pe,n.__scopeScrollArea),[i,a]=g.useState(),l=g.useRef(null),u=ye(e,l,o.onScrollbarXChange);return g.useEffect(()=>{l.current&&a(getComputedStyle(l.current))},[l]),v.jsx(Vs,{"data-orientation":"horizontal",...s,ref:u,sizes:t,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Jt(t)+"px",...n.style},onThumbPointerDown:c=>n.onThumbPointerDown(c.x),onDragScroll:c=>n.onDragScroll(c.x),onWheelScroll:(c,h)=>{if(o.viewport){const d=o.viewport.scrollLeft+c.deltaX;n.onWheelScroll(d),Xs(d,h)&&c.preventDefault()}},onResize:()=>{l.current&&o.viewport&&i&&r({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:Gt(i.paddingLeft),paddingEnd:Gt(i.paddingRight)}})}})}),oc=g.forwardRef((n,e)=>{const{sizes:t,onSizesChange:r,...s}=n,o=xe(Pe,n.__scopeScrollArea),[i,a]=g.useState(),l=g.useRef(null),u=ye(e,l,o.onScrollbarYChange);return g.useEffect(()=>{l.current&&a(getComputedStyle(l.current))},[l]),v.jsx(Vs,{"data-orientation":"vertical",...s,ref:u,sizes:t,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Jt(t)+"px",...n.style},onThumbPointerDown:c=>n.onThumbPointerDown(c.y),onDragScroll:c=>n.onDragScroll(c.y),onWheelScroll:(c,h)=>{if(o.viewport){const d=o.viewport.scrollTop+c.deltaY;n.onWheelScroll(d),Xs(d,h)&&c.preventDefault()}},onResize:()=>{l.current&&o.viewport&&i&&r({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:Gt(i.paddingTop),paddingEnd:Gt(i.paddingBottom)}})}})}),[ic,qs]=Us(Pe),Vs=g.forwardRef((n,e)=>{const{__scopeScrollArea:t,sizes:r,hasThumb:s,onThumbChange:o,onThumbPointerUp:i,onThumbPointerDown:a,onThumbPositionChange:l,onDragScroll:u,onWheelScroll:c,onResize:h,...d}=n,p=xe(Pe,t),[y,m]=g.useState(null),w=ye(e,$=>m($)),S=g.useRef(null),b=g.useRef(""),k=p.viewport,x=r.content-r.viewport,T=he(c),j=he(l),O=Kt(h,10);function N($){if(S.current){const B=$.clientX-S.current.left,Q=$.clientY-S.current.top;u({x:B,y:Q})}}return g.useEffect(()=>{const $=B=>{const Q=B.target;(y==null?void 0:y.contains(Q))&&T(B,x)};return document.addEventListener("wheel",$,{passive:!1}),()=>document.removeEventListener("wheel",$,{passive:!1})},[k,y,x,T]),g.useEffect(j,[r,j]),at(y,O),at(p.content,O),v.jsx(ic,{scope:t,scrollbar:y,hasThumb:s,onThumbChange:he(o),onThumbPointerUp:he(i),onThumbPositionChange:j,onThumbPointerDown:he(a),children:v.jsx(fe.div,{...d,ref:w,style:{position:"absolute",...d.style},onPointerDown:ue(n.onPointerDown,$=>{$.button===0&&($.target.setPointerCapture($.pointerId),S.current=y.getBoundingClientRect(),b.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),N($))}),onPointerMove:ue(n.onPointerMove,N),onPointerUp:ue(n.onPointerUp,$=>{const B=$.target;B.hasPointerCapture($.pointerId)&&B.releasePointerCapture($.pointerId),document.body.style.webkitUserSelect=b.current,p.viewport&&(p.viewport.style.scrollBehavior=""),S.current=null})})})}),Ht="ScrollAreaThumb",Hs=g.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=qs(Ht,n.__scopeScrollArea);return v.jsx(Ne,{present:t||s.hasThumb,children:v.jsx(ac,{ref:e,...r})})}),ac=g.forwardRef((n,e)=>{const{__scopeScrollArea:t,style:r,...s}=n,o=xe(Ht,t),i=qs(Ht,t),{onThumbPositionChange:a}=i,l=ye(e,h=>i.onThumbChange(h)),u=g.useRef(),c=Kt(()=>{u.current&&(u.current(),u.current=void 0)},100);return g.useEffect(()=>{const h=o.viewport;if(h){const d=()=>{if(c(),!u.current){const p=uc(h,a);u.current=p,a()}};return a(),h.addEventListener("scroll",d),()=>h.removeEventListener("scroll",d)}},[o.viewport,c,a]),v.jsx(fe.div,{"data-state":i.hasThumb?"visible":"hidden",...s,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:ue(n.onPointerDownCapture,h=>{const p=h.target.getBoundingClientRect(),y=h.clientX-p.left,m=h.clientY-p.top;i.onThumbPointerDown({x:y,y:m})}),onPointerUp:ue(n.onPointerUp,i.onThumbPointerUp)})});Hs.displayName=Ht;var Wr="ScrollAreaCorner",Gs=g.forwardRef((n,e)=>{const t=xe(Wr,n.__scopeScrollArea),r=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&r?v.jsx(lc,{...n,ref:e}):null});Gs.displayName=Wr;var lc=g.forwardRef((n,e)=>{const{__scopeScrollArea:t,...r}=n,s=xe(Wr,t),[o,i]=g.useState(0),[a,l]=g.useState(0),u=!!(o&&a);return at(s.scrollbarX,()=>{var h;const c=((h=s.scrollbarX)==null?void 0:h.offsetHeight)||0;s.onCornerHeightChange(c),l(c)}),at(s.scrollbarY,()=>{var h;const c=((h=s.scrollbarY)==null?void 0:h.offsetWidth)||0;s.onCornerWidthChange(c),i(c)}),u?v.jsx(fe.div,{...r,ref:e,style:{width:o,height:a,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...n.style}}):null});function Gt(n){return n?parseInt(n,10):0}function Js(n,e){const t=n/e;return isNaN(t)?0:t}function Jt(n){const e=Js(n.viewport,n.content),t=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,r=(n.scrollbar.size-t)*e;return Math.max(r,18)}function cc(n,e,t,r="ltr"){const s=Jt(t),o=s/2,i=e||o,a=s-i,l=t.scrollbar.paddingStart+i,u=t.scrollbar.size-t.scrollbar.paddingEnd-a,c=t.content-t.viewport,h=r==="ltr"?[0,c]:[c*-1,0];return Ys([l,u],h)(n)}function Ks(n,e,t="ltr"){const r=Jt(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,o=e.scrollbar.size-s,i=e.content-e.viewport,a=o-r,l=t==="ltr"?[0,i]:[i*-1,0],u=Ql(n,l);return Ys([0,i],[0,a])(u)}function Ys(n,e){return t=>{if(n[0]===n[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(n[1]-n[0]);return e[0]+r*(t-n[0])}}function Xs(n,e){return n>0&&n<e}var uc=(n,e=()=>{})=>{let t={left:n.scrollLeft,top:n.scrollTop},r=0;return function s(){const o={left:n.scrollLeft,top:n.scrollTop},i=t.left!==o.left,a=t.top!==o.top;(i||a)&&e(),t=o,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function Kt(n,e){const t=he(n),r=g.useRef(0);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),g.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(t,e)},[t,e])}function at(n,e){const t=he(e);wt(()=>{let r=0;if(n){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(t)});return s.observe(n),()=>{window.cancelAnimationFrame(r),s.unobserve(n)}}},[n,t])}function dc(n,e){const{asChild:t,children:r}=n;if(!t)return typeof e=="function"?e(r):e;const s=g.Children.only(r);return g.cloneElement(s,{children:typeof e=="function"?e(s.props.children):e})}var Zs=Fs,hc=Bs,fc=Gs;const Qs=g.forwardRef(({className:n,children:e,...t},r)=>v.jsxs(Zs,{ref:r,className:Fe("relative overflow-hidden",n),...t,children:[v.jsx(hc,{className:"h-full w-full rounded-[inherit]",children:e}),v.jsx(eo,{}),v.jsx(fc,{})]}));Qs.displayName=Zs.displayName;const eo=g.forwardRef(({className:n,orientation:e="vertical",...t},r)=>v.jsx(zr,{ref:r,orientation:e,className:Fe("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",n),...t,children:v.jsx(Hs,{className:"relative flex-1 rounded-full bg-border"})}));eo.displayName=zr.displayName;function qr(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Ge=qr();function to(n){Ge=n}const ro=/[&<>"']/,pc=new RegExp(ro.source,"g"),no=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,gc=new RegExp(no.source,"g"),mc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},so=n=>mc[n];function we(n,e){if(e){if(ro.test(n))return n.replace(pc,so)}else if(no.test(n))return n.replace(gc,so);return n}const vc=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function bc(n){return n.replace(vc,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const yc=/(^|[^\[])\^/g;function H(n,e){n=typeof n=="string"?n:n.source,e=e||"";const t={replace:(r,s)=>(s=typeof s=="object"&&"source"in s?s.source:s,s=s.replace(yc,"$1"),n=n.replace(r,s),t),getRegex:()=>new RegExp(n,e)};return t}function oo(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const Yt={exec:()=>null};function io(n,e){const t=n.replace(/\|/g,(o,i,a)=>{let l=!1,u=i;for(;--u>=0&&a[u]==="\\";)l=!l;return l?"|":" |"}),r=t.split(/ \|/);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(/\\\|/g,"|");return r}function Xt(n,e,t){const r=n.length;if(r===0)return"";let s=0;for(;s<r;){const o=n.charAt(r-s-1);if(o===e&&!t)s++;else if(o!==e&&t)s++;else break}return n.slice(0,r-s)}function wc(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return-1}function ao(n,e,t,r){const s=e.href,o=e.title?we(e.title):null,i=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){r.state.inLink=!0;const a={type:"link",raw:t,href:s,title:o,text:i,tokens:r.inlineTokens(i)};return r.state.inLink=!1,a}return{type:"image",raw:t,href:s,title:o,text:we(i)}}function _c(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const r=t[1];return e.split(`
`).map(s=>{const o=s.match(/^\s+/);if(o===null)return s;const[i]=o;return i.length>=r.length?s.slice(r.length):s}).join(`
`)}class Zt{constructor(e){K(this,"options");K(this,"rules");K(this,"lexer");this.options=e||Ge}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Xt(r,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],s=_c(r,t[3]||"");return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline._escapes,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(/#$/.test(r)){const s=Xt(r,"#");(this.options.pedantic||!s||/ $/.test(s))&&(r=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const r=Xt(t[0].replace(/^ *>[ \t]?/gm,""),`
`),s=this.lexer.state.top;this.lexer.state.top=!0;const o=this.lexer.blockTokens(r);return this.lexer.state.top=s,{type:"blockquote",raw:t[0],tokens:o,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim();const s=r.length>1,o={type:"list",raw:"",ordered:s,start:s?+r.slice(0,-1):"",loose:!1,items:[]};r=s?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=s?r:"[*+-]");const i=new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a="",l="",u=!1;for(;e;){let c=!1;if(!(t=i.exec(e))||this.rules.block.hr.test(e))break;a=t[0],e=e.substring(a.length);let h=t[2].split(`
`,1)[0].replace(/^\t+/,S=>" ".repeat(3*S.length)),d=e.split(`
`,1)[0],p=0;this.options.pedantic?(p=2,l=h.trimStart()):(p=t[2].search(/[^ ]/),p=p>4?1:p,l=h.slice(p),p+=t[1].length);let y=!1;if(!h&&/^ *$/.test(d)&&(a+=d+`
`,e=e.substring(d.length+1),c=!0),!c){const S=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),b=new RegExp(`^ {0,${Math.min(3,p-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),k=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:\`\`\`|~~~)`),x=new RegExp(`^ {0,${Math.min(3,p-1)}}#`);for(;e;){const T=e.split(`
`,1)[0];if(d=T,this.options.pedantic&&(d=d.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),k.test(d)||x.test(d)||S.test(d)||b.test(e))break;if(d.search(/[^ ]/)>=p||!d.trim())l+=`
`+d.slice(p);else{if(y||h.search(/[^ ]/)>=4||k.test(h)||x.test(h)||b.test(h))break;l+=`
`+d}!y&&!d.trim()&&(y=!0),a+=T+`
`,e=e.substring(T.length+1),h=d.slice(p)}}o.loose||(u?o.loose=!0:/\n *\n *$/.test(a)&&(u=!0));let m=null,w;this.options.gfm&&(m=/^\[[ xX]\] /.exec(l),m&&(w=m[0]!=="[ ] ",l=l.replace(/^\[[ xX]\] +/,""))),o.items.push({type:"list_item",raw:a,task:!!m,checked:w,loose:!1,text:l,tokens:[]}),o.raw+=a}o.items[o.items.length-1].raw=a.trimEnd(),o.items[o.items.length-1].text=l.trimEnd(),o.raw=o.raw.trimEnd();for(let c=0;c<o.items.length;c++)if(this.lexer.state.top=!1,o.items[c].tokens=this.lexer.blockTokens(o.items[c].text,[]),!o.loose){const h=o.items[c].tokens.filter(p=>p.type==="space"),d=h.length>0&&h.some(p=>/\n.*\n/.test(p.raw));o.loose=d}if(o.loose)for(let c=0;c<o.items.length;c++)o.items[c].loose=!0;return o}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const r=t[1].toLowerCase().replace(/\s+/g," "),s=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",o=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline._escapes,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:s,title:o}}}table(e){const t=this.rules.block.table.exec(e);if(t){if(!/[:|]/.test(t[2]))return;const r={type:"table",raw:t[0],header:io(t[1]).map(s=>({text:s,tokens:[]})),align:t[2].replace(/^\||\| *$/g,"").split("|"),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(r.header.length===r.align.length){let s=r.align.length,o,i,a,l;for(o=0;o<s;o++){const u=r.align[o];u&&(/^ *-+: *$/.test(u)?r.align[o]="right":/^ *:-+: *$/.test(u)?r.align[o]="center":/^ *:-+ *$/.test(u)?r.align[o]="left":r.align[o]=null)}for(s=r.rows.length,o=0;o<s;o++)r.rows[o]=io(r.rows[o],r.header.length).map(u=>({text:u,tokens:[]}));for(s=r.header.length,i=0;i<s;i++)r.header[i].tokens=this.lexer.inline(r.header[i].text);for(s=r.rows.length,i=0;i<s;i++)for(l=r.rows[i],a=0;a<l.length;a++)l[a].tokens=this.lexer.inline(l[a].text);return r}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:we(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const i=Xt(r.slice(0,-1),"\\");if((r.length-i.length)%2===0)return}else{const i=wc(t[2],"()");if(i>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let s=t[2],o="";if(this.options.pedantic){const i=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);i&&(s=i[1],o=i[3])}else o=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(this.options.pedantic&&!/>$/.test(r)?s=s.slice(1):s=s.slice(1,-1)),ao(t,{href:s&&s.replace(this.rules.inline._escapes,"$1"),title:o&&o.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){let s=(r[2]||r[1]).replace(/\s+/g," ");if(s=t[s.toLowerCase()],!s){const o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return ao(r,s,r[0],this.lexer)}}emStrong(e,t,r=""){let s=this.rules.inline.emStrong.lDelim.exec(e);if(!s||s[3]&&r.match(/[\p{L}\p{N}]/u))return;if(!(s[1]||s[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const i=[...s[0]].length-1;let a,l,u=i,c=0;const h=s[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(h.lastIndex=0,t=t.slice(-1*e.length+s[0].length-1);(s=h.exec(t))!=null;){if(a=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!a)continue;if(l=[...a].length,s[3]||s[4]){u+=l;continue}else if((s[5]||s[6])&&i%3&&!((i+l)%3)){c+=l;continue}if(u-=l,u>0)continue;l=Math.min(l,l+u+c);const d=[...e].slice(0,i+s.index+l+1).join("");if(Math.min(i,l)%2){const y=d.slice(1,-1);return{type:"em",raw:d,text:y,tokens:this.lexer.inlineTokens(y)}}const p=d.slice(2,-2);return{type:"strong",raw:d,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(/\n/g," ");const s=/[^ ]/.test(r),o=/^ /.test(r)&&/ $/.test(r);return s&&o&&(r=r.substring(1,r.length-1)),r=we(r,!0),{type:"codespan",raw:t[0],text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let r,s;return t[2]==="@"?(r=we(t[1]),s="mailto:"+r):(r=we(t[1]),s=r),{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let r,s;if(t[2]==="@")r=we(t[0]),s="mailto:"+r;else{let o;do o=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])[0];while(o!==t[0]);r=we(t[0]),t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let r;return this.lexer.state.inRawBlock?r=t[0]:r=we(t[0]),{type:"text",raw:t[0],text:r}}}}const I={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Yt,lheading:/^(?!bull )((?:.|\n(?!\s*?\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};I._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/,I._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,I.def=H(I.def).replace("label",I._label).replace("title",I._title).getRegex(),I.bullet=/(?:[*+-]|\d{1,9}[.)])/,I.listItemStart=H(/^( *)(bull) */).replace("bull",I.bullet).getRegex(),I.list=H(I.list).replace(/bull/g,I.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+I.def.source+")").getRegex(),I._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",I._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,I.html=H(I.html,"i").replace("comment",I._comment).replace("tag",I._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),I.lheading=H(I.lheading).replace(/bull/g,I.bullet).getRegex(),I.paragraph=H(I._paragraph).replace("hr",I.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",I._tag).getRegex(),I.blockquote=H(I.blockquote).replace("paragraph",I.paragraph).getRegex(),I.normal={...I},I.gfm={...I.normal,table:"^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"},I.gfm.table=H(I.gfm.table).replace("hr",I.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",I._tag).getRegex(),I.gfm.paragraph=H(I._paragraph).replace("hr",I.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",I.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",I._tag).getRegex(),I.pedantic={...I.normal,html:H(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",I._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Yt,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:H(I.normal._paragraph).replace("hr",I.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",I.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const P={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Yt,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,rDelimAst:/^[^_*]*?__[^_*]*?\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\*)[punct](\*+)(?=[\s]|$)|[^punct\s](\*+)(?!\*)(?=[punct\s]|$)|(?!\*)[punct\s](\*+)(?=[^punct\s])|[\s](\*+)(?!\*)(?=[punct])|(?!\*)[punct](\*+)(?!\*)(?=[punct])|[^punct\s](\*+)(?=[^punct\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\s]|$)|[^punct\s](_+)(?!_)(?=[punct\s]|$)|(?!_)[punct\s](_+)(?=[^punct\s])|[\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Yt,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^((?![*_])[\spunctuation])/};P._punctuation="\\p{P}$+<=>`^|~",P.punctuation=H(P.punctuation,"u").replace(/punctuation/g,P._punctuation).getRegex(),P.blockSkip=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,P.anyPunctuation=/\\[punct]/g,P._escapes=/\\([punct])/g,P._comment=H(I._comment).replace("(?:-->|$)","-->").getRegex(),P.emStrong.lDelim=H(P.emStrong.lDelim,"u").replace(/punct/g,P._punctuation).getRegex(),P.emStrong.rDelimAst=H(P.emStrong.rDelimAst,"gu").replace(/punct/g,P._punctuation).getRegex(),P.emStrong.rDelimUnd=H(P.emStrong.rDelimUnd,"gu").replace(/punct/g,P._punctuation).getRegex(),P.anyPunctuation=H(P.anyPunctuation,"gu").replace(/punct/g,P._punctuation).getRegex(),P._escapes=H(P._escapes,"gu").replace(/punct/g,P._punctuation).getRegex(),P._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,P._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,P.autolink=H(P.autolink).replace("scheme",P._scheme).replace("email",P._email).getRegex(),P._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,P.tag=H(P.tag).replace("comment",P._comment).replace("attribute",P._attribute).getRegex(),P._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,P._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,P._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,P.link=H(P.link).replace("label",P._label).replace("href",P._href).replace("title",P._title).getRegex(),P.reflink=H(P.reflink).replace("label",P._label).replace("ref",I._label).getRegex(),P.nolink=H(P.nolink).replace("ref",I._label).getRegex(),P.reflinkSearch=H(P.reflinkSearch,"g").replace("reflink",P.reflink).replace("nolink",P.nolink).getRegex(),P.normal={...P},P.pedantic={...P.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:H(/^!?\[(label)\]\((.*?)\)/).replace("label",P._label).getRegex(),reflink:H(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",P._label).getRegex()},P.gfm={...P.normal,escape:H(P.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},P.gfm.url=H(P.gfm.url,"i").replace("email",P.gfm._extended_email).getRegex(),P.breaks={...P.gfm,br:H(P.br).replace("{2,}","*").getRegex(),text:H(P.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};class Re{constructor(e){K(this,"tokens");K(this,"options");K(this,"state");K(this,"tokenizer");K(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ge,this.options.tokenizer=this.options.tokenizer||new Zt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:I.normal,inline:P.normal};this.options.pedantic?(t.block=I.pedantic,t.inline=P.pedantic):this.options.gfm&&(t.block=I.gfm,this.options.breaks?t.inline=P.breaks:t.inline=P.gfm),this.tokenizer.rules=t}static get rules(){return{block:I,inline:P}}static lex(e,t){return new Re(t).lex(e)}static lexInline(e,t){return new Re(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,l,u)=>l+"    ".repeat(u.length));let r,s,o,i;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(r=a.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+r.raw,s.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(o=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=e.slice(1);let u;this.options.extensions.startBlock.forEach(c=>{u=c.call({lexer:this},l),typeof u=="number"&&u>=0&&(a=Math.min(a,u))}),a<1/0&&a>=0&&(o=e.substring(0,a+1))}if(this.state.top&&(r=this.tokenizer.paragraph(o))){s=t[t.length-1],i&&s.type==="paragraph"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r),i=o.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&s.type==="text"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r,s,o,i=e,a,l,u;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)c.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,a.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(u=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(c=>(r=c.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length),s=t[t.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,i,u)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e))){e=e.substring(r.raw.length),t.push(r);continue}if(o=e,this.options.extensions&&this.options.extensions.startInline){let c=1/0;const h=e.slice(1);let d;this.options.extensions.startInline.forEach(p=>{d=p.call({lexer:this},h),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(o=e.substring(0,c+1))}if(r=this.tokenizer.inlineText(o)){e=e.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(u=r.raw.slice(-1)),l=!0,s=t[t.length-1],s&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if(e){const c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return t}}class Qt{constructor(e){K(this,"options");this.options=e||Ge}code(e,t,r){var o;const s=(o=(t||"").match(/^\S*/))==null?void 0:o[0];return e=e.replace(/\n$/,"")+`
`,s?'<pre><code class="language-'+we(s)+'">'+(r?e:we(e,!0))+`</code></pre>
`:"<pre><code>"+(r?e:we(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,r){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}list(e,t,r){const s=t?"ol":"ul",o=t&&r!==1?' start="'+r+'"':"";return"<"+s+o+`>
`+e+"</"+s+`>
`}listitem(e,t,r){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,r){const s=oo(e);if(s===null)return r;e=s;let o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+r+"</a>",o}image(e,t,r){const s=oo(e);if(s===null)return r;e=s;let o=`<img src="${e}" alt="${r}"`;return t&&(o+=` title="${t}"`),o+=">",o}text(e){return e}}class Vr{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,r){return""+r}image(e,t,r){return""+r}br(){return""}}class $e{constructor(e){K(this,"options");K(this,"renderer");K(this,"textRenderer");this.options=e||Ge,this.options.renderer=this.options.renderer||new Qt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Vr}static parse(e,t){return new $e(t).parse(e)}static parseInline(e,t){return new $e(t).parseInline(e)}parse(e,t=!0){let r="";for(let s=0;s<e.length;s++){const o=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]){const i=o,a=this.options.extensions.renderers[i.type].call({parser:this},i);if(a!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(i.type)){r+=a||"";continue}}switch(o.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{const i=o;r+=this.renderer.heading(this.parseInline(i.tokens),i.depth,bc(this.parseInline(i.tokens,this.textRenderer)));continue}case"code":{const i=o;r+=this.renderer.code(i.text,i.lang,!!i.escaped);continue}case"table":{const i=o;let a="",l="";for(let c=0;c<i.header.length;c++)l+=this.renderer.tablecell(this.parseInline(i.header[c].tokens),{header:!0,align:i.align[c]});a+=this.renderer.tablerow(l);let u="";for(let c=0;c<i.rows.length;c++){const h=i.rows[c];l="";for(let d=0;d<h.length;d++)l+=this.renderer.tablecell(this.parseInline(h[d].tokens),{header:!1,align:i.align[d]});u+=this.renderer.tablerow(l)}r+=this.renderer.table(a,u);continue}case"blockquote":{const i=o,a=this.parse(i.tokens);r+=this.renderer.blockquote(a);continue}case"list":{const i=o,a=i.ordered,l=i.start,u=i.loose;let c="";for(let h=0;h<i.items.length;h++){const d=i.items[h],p=d.checked,y=d.task;let m="";if(d.task){const w=this.renderer.checkbox(!!p);u?d.tokens.length>0&&d.tokens[0].type==="paragraph"?(d.tokens[0].text=w+" "+d.tokens[0].text,d.tokens[0].tokens&&d.tokens[0].tokens.length>0&&d.tokens[0].tokens[0].type==="text"&&(d.tokens[0].tokens[0].text=w+" "+d.tokens[0].tokens[0].text)):d.tokens.unshift({type:"text",text:w+" "}):m+=w+" "}m+=this.parse(d.tokens,u),c+=this.renderer.listitem(m,y,!!p)}r+=this.renderer.list(c,a,l);continue}case"html":{const i=o;r+=this.renderer.html(i.text,i.block);continue}case"paragraph":{const i=o;r+=this.renderer.paragraph(this.parseInline(i.tokens));continue}case"text":{let i=o,a=i.tokens?this.parseInline(i.tokens):i.text;for(;s+1<e.length&&e[s+1].type==="text";)i=e[++s],a+=`
`+(i.tokens?this.parseInline(i.tokens):i.text);r+=t?this.renderer.paragraph(a):a;continue}default:{const i='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return r}parseInline(e,t){t=t||this.renderer;let r="";for(let s=0;s<e.length;s++){const o=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]){const i=this.options.extensions.renderers[o.type].call({parser:this},o);if(i!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=i||"";continue}}switch(o.type){case"escape":{const i=o;r+=t.text(i.text);break}case"html":{const i=o;r+=t.html(i.text);break}case"link":{const i=o;r+=t.link(i.href,i.title,this.parseInline(i.tokens,t));break}case"image":{const i=o;r+=t.image(i.href,i.title,i.text);break}case"strong":{const i=o;r+=t.strong(this.parseInline(i.tokens,t));break}case"em":{const i=o;r+=t.em(this.parseInline(i.tokens,t));break}case"codespan":{const i=o;r+=t.codespan(i.text);break}case"br":{r+=t.br();break}case"del":{const i=o;r+=t.del(this.parseInline(i.tokens,t));break}case"text":{const i=o;r+=t.text(i.text);break}default:{const i='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return r}}class xt{constructor(e){K(this,"options");this.options=e||Ge}preprocess(e){return e}postprocess(e){return e}}K(xt,"passThroughHooks",new Set(["preprocess","postprocess"]));class kc{constructor(...e){fi(this,Qe);K(this,"defaults",qr());K(this,"options",this.setOptions);K(this,"parse",vr(this,Qe,Cn).call(this,Re.lex,$e.parse));K(this,"parseInline",vr(this,Qe,Cn).call(this,Re.lexInline,$e.parseInline));K(this,"Parser",$e);K(this,"parser",$e.parse);K(this,"Renderer",Qt);K(this,"TextRenderer",Vr);K(this,"Lexer",Re);K(this,"lexer",Re.lex);K(this,"Tokenizer",Zt);K(this,"Hooks",xt);this.use(...e)}walkTokens(e,t){var s,o;let r=[];for(const i of e)switch(r=r.concat(t.call(this,i)),i.type){case"table":{const a=i;for(const l of a.header)r=r.concat(this.walkTokens(l.tokens,t));for(const l of a.rows)for(const u of l)r=r.concat(this.walkTokens(u.tokens,t));break}case"list":{const a=i;r=r.concat(this.walkTokens(a.items,t));break}default:{const a=i;(o=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&o[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{r=r.concat(this.walkTokens(a[l],t))}):a.tokens&&(r=r.concat(this.walkTokens(a.tokens,t)))}}return r}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(r=>{const s={...r};if(s.async=this.defaults.async||s.async||!1,r.extensions&&(r.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if("renderer"in o){const i=t.renderers[o.name];i?t.renderers[o.name]=function(...a){let l=o.renderer.apply(this,a);return l===!1&&(l=i.apply(this,a)),l}:t.renderers[o.name]=o.renderer}if("tokenizer"in o){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const i=t[o.level];i?i.unshift(o.tokenizer):t[o.level]=[o.tokenizer],o.start&&(o.level==="block"?t.startBlock?t.startBlock.push(o.start):t.startBlock=[o.start]:o.level==="inline"&&(t.startInline?t.startInline.push(o.start):t.startInline=[o.start]))}"childTokens"in o&&o.childTokens&&(t.childTokens[o.name]=o.childTokens)}),s.extensions=t),r.renderer){const o=this.defaults.renderer||new Qt(this.defaults);for(const i in r.renderer){const a=r.renderer[i],l=i,u=o[l];o[l]=(...c)=>{let h=a.apply(o,c);return h===!1&&(h=u.apply(o,c)),h||""}}s.renderer=o}if(r.tokenizer){const o=this.defaults.tokenizer||new Zt(this.defaults);for(const i in r.tokenizer){const a=r.tokenizer[i],l=i,u=o[l];o[l]=(...c)=>{let h=a.apply(o,c);return h===!1&&(h=u.apply(o,c)),h}}s.tokenizer=o}if(r.hooks){const o=this.defaults.hooks||new xt;for(const i in r.hooks){const a=r.hooks[i],l=i,u=o[l];xt.passThroughHooks.has(i)?o[l]=c=>{if(this.defaults.async)return Promise.resolve(a.call(o,c)).then(d=>u.call(o,d));const h=a.call(o,c);return u.call(o,h)}:o[l]=(...c)=>{let h=a.apply(o,c);return h===!1&&(h=u.apply(o,c)),h}}s.hooks=o}if(r.walkTokens){const o=this.defaults.walkTokens,i=r.walkTokens;s.walkTokens=function(a){let l=[];return l.push(i.call(this,a)),o&&(l=l.concat(o.call(this,a))),l}}this.defaults={...this.defaults,...s}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}}Qe=new WeakSet,Cn=function(e,t){return(r,s)=>{const o={...s},i={...this.defaults,...o};this.defaults.async===!0&&o.async===!1&&(i.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),i.async=!0);const a=vr(this,Qe,pi).call(this,!!i.silent,!!i.async);if(typeof r>"u"||r===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(i.hooks&&(i.hooks.options=i),i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(r):r).then(l=>e(l,i)).then(l=>i.walkTokens?Promise.all(this.walkTokens(l,i.walkTokens)).then(()=>l):l).then(l=>t(l,i)).then(l=>i.hooks?i.hooks.postprocess(l):l).catch(a);try{i.hooks&&(r=i.hooks.preprocess(r));const l=e(r,i);i.walkTokens&&this.walkTokens(l,i.walkTokens);let u=t(l,i);return i.hooks&&(u=i.hooks.postprocess(u)),u}catch(l){return a(l)}}},pi=function(e,t){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const s="<p>An error occurred:</p><pre>"+we(r.message+"",!0)+"</pre>";return t?Promise.resolve(s):s}if(t)return Promise.reject(r);throw r}};const Je=new kc;function Y(n,e){return Je.parse(n,e)}Y.options=Y.setOptions=function(n){return Je.setOptions(n),Y.defaults=Je.defaults,to(Y.defaults),Y},Y.getDefaults=qr,Y.defaults=Ge,Y.use=function(...n){return Je.use(...n),Y.defaults=Je.defaults,to(Y.defaults),Y},Y.walkTokens=function(n,e){return Je.walkTokens(n,e)},Y.parseInline=Je.parseInline,Y.Parser=$e,Y.parser=$e.parse,Y.Renderer=Qt,Y.TextRenderer=Vr,Y.Lexer=Re,Y.lexer=Re.lex,Y.Tokenizer=Zt,Y.Hooks=xt,Y.parse=Y,Y.options,Y.setOptions,Y.use,Y.walkTokens,Y.parseInline,$e.parse,Re.lex;const lo=({content:n,isUser:e})=>{const t=()=>{if(!n)return{__html:""};try{return{__html:Y(n)}}catch(r){return console.error("Error parsing markdown:",r),{__html:n}}};return v.jsx("div",{className:Fe("flex mb-2",e?"justify-end":"justify-start"),children:v.jsx("div",{className:Fe("max-w-[80%] p-3 rounded-lg shadow-sm",e?"bg-blue-600 text-white rounded-tr-none":"bg-gray-800/80 backdrop-blur-sm text-gray-100 rounded-tl-none"),children:n?v.jsx("div",{className:"prose prose-sm prose-invert max-w-none break-words",dangerouslySetInnerHTML:t()}):v.jsx("span",{className:"text-gray-400 italic",children:"Пустое сообщение"})})})},co=()=>v.jsxs("div",{className:"inline-flex gap-1",children:[v.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full",style:{animation:"typingDot 1.4s infinite ease-in-out",animationDelay:"0ms"}}),v.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full",style:{animation:"typingDot 1.4s infinite ease-in-out",animationDelay:"200ms"}}),v.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full",style:{animation:"typingDot 1.4s infinite ease-in-out",animationDelay:"400ms"}}),v.jsx("style",{children:`
      @keyframes typingDot {
        0%, 100% { transform: translateY(0); opacity: 0.5; }
        50% { transform: translateY(-1px); opacity: 1; }
      }
    `})]}),xc=({messages:n,isLoading:e,isExpanded:t})=>{const r=A.useRef(null),s=A.useRef(null),[o,i]=A.useState(!1),[a,l]=A.useState(!0),u=A.useRef(n.length),c=()=>{a&&s.current&&!o&&s.current.scrollIntoView({behavior:"smooth",block:"end"})},h=d=>{if(!r.current)return;const{scrollTop:p,scrollHeight:y,clientHeight:m}=d.currentTarget,w=Math.abs(y-p-m)<20;l(w),o&&setTimeout(()=>i(!1),150)};return A.useEffect(()=>{const d=document.querySelector("[data-radix-scroll-area-viewport]");if(d){const p=()=>{i(!0)};return d.addEventListener("wheel",p,{passive:!0}),d.addEventListener("touchmove",p,{passive:!0}),()=>{d.removeEventListener("wheel",p),d.removeEventListener("touchmove",p)}}},[]),A.useEffect(()=>{const d=n.length>u.current;if(u.current=n.length,d||e){const p=setTimeout(()=>{c()},200);return()=>clearTimeout(p)}},[n,e]),v.jsx("div",{className:`w-full mb-6 ${t?"flex-grow":"h-48"} overflow-hidden bg-transparent rounded-lg`,children:v.jsx(Qs,{className:"h-full pr-4",type:"auto",scrollHideDelay:300,children:v.jsxs("div",{className:"px-2 py-1",ref:r,onScroll:h,children:[n.length===0&&v.jsx("div",{className:"p-3 text-gray-200",children:v.jsx("p",{className:"text-sm",children:"Начните диалог с ассистентом Амика, отправив текстовое или голосовое сообщение."})}),n.map((d,p)=>{var m;const y=d.id||`message-${p}-${Date.now()}-${((m=d.user_query)==null?void 0:m.substring(0,10))||"bot"}`;return v.jsxs("div",{className:"mb-3 animate-fade-in",children:[d.user_query&&v.jsx(lo,{content:d.user_query,isUser:!0}),d.isLoading?v.jsx("div",{className:"flex justify-start",children:v.jsx("div",{className:"max-w-[80%] bg-gray-800/80 backdrop-blur-sm rounded-lg px-4 py-3 text-gray-100 shadow-md",children:v.jsx(co,{})})}):v.jsx(lo,{content:d.bot_response,isUser:!1})]},y)}),e&&!n.find(d=>d.isLoading)&&v.jsx("div",{className:"flex justify-start mb-3 animate-fade-in",children:v.jsx("div",{className:"inline-flex items-center bg-gray-800/80 backdrop-blur-sm rounded-lg px-3 py-2 shadow-md",children:v.jsx(co,{})})}),v.jsx("div",{ref:s,className:"h-px"})," "]})})})},Sc=({userInput:n,onUserInputChange:e,onSendMessage:t,isLoading:r})=>{const s=o=>{o.key==="Enter"&&t()};return v.jsxs("div",{className:"flex-grow flex items-center gap-2 bg-gray-700/30 rounded-full pl-4 pr-2 py-2 animate-fade-in",children:[v.jsx("input",{type:"text",className:"bg-transparent border-none outline-none text-gray-100 flex-grow text-sm",placeholder:"Напишите сообщение...",value:n,onChange:e,onKeyPress:s,disabled:r}),v.jsx("button",{onClick:t,className:`p-2 ${r?"bg-gray-500":"bg-blue-500 hover:bg-blue-600"} rounded-full transition-colors`,disabled:r,children:r?v.jsx(tl,{size:16,className:"text-white animate-spin"}):v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[v.jsx("path",{d:"M22 2L11 13"}),v.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z"})]})})]})},Ec=({isListening:n,isSpeaking:e,voiceVolume:t,transcript:r,onCircleClick:s,isExpanded:o,isInputVisible:i,userInput:a,onUserInputChange:l,onSendMessage:u,messages:c,isLoading:h,createTask:d})=>v.jsxs("div",{className:`flex flex-col items-center justify-between ${o?"h-[80vh]":"h-[500px]"} transition-all duration-300`,children:[v.jsx(Yl,{isListening:n,isSpeaking:e}),v.jsx(xc,{messages:c,isLoading:h,isExpanded:o}),v.jsx("div",{className:"w-full flex items-center justify-center mb-4 transition-all duration-300",children:v.jsxs("div",{className:"flex items-center justify-between w-full px-4 gap-4",children:[v.jsx("div",{className:"transition-all duration-300",children:v.jsx(Kl,{isListening:n,isSpeaking:e,voiceVolume:t,onClick:s})}),v.jsx(Sc,{userInput:a,onUserInputChange:l,onSendMessage:u,isLoading:h})]})})]}),Tc=({isExpanded:n,toggleFullscreen:e,dialogPosition:t,isListening:r,isSpeaking:s,voiceVolume:o,transcript:i,onCircleClick:a,userInput:l,onUserInputChange:u,onSendMessage:c,messages:h,isLoading:d,createTask:p})=>{const y=A.useMemo(()=>{try{return window.self!==window.top}catch{return!0}},[]);return v.jsxs(Ds,{className:`sm:max-w-md bg-gradient-to-b from-gray-900 to-gray-800 border-none shadow-2xl animate-fade-in ${n?"fixed inset-0 max-w-full max-h-full rounded-none":"rounded-xl"}`,style:n?{position:"fixed",top:"0",left:"0",right:"0",bottom:"0",width:"100%",height:"100%",maxWidth:"100%",transform:"none",margin:"0",borderRadius:"0"}:{position:"absolute",top:`${Math.max(20,t.top)}px`,left:`${t.left+3}px`,transform:"none",minHeight:"500px",width:"420px",...y?{position:"fixed",top:"20px",right:"20px",left:"auto"}:{}},children:[v.jsx("div",{className:"absolute right-4 top-4 flex items-center gap-2 z-10",children:v.jsx("button",{onClick:e,className:"text-gray-300 hover:text-white transition-colors p-2 bg-gray-800/50 rounded-full",children:n?v.jsx(nl,{size:18}):v.jsx(rl,{size:18})})}),v.jsx(Ec,{isListening:r,isSpeaking:s,voiceVolume:o,transcript:i,onCircleClick:a,isExpanded:n,isInputVisible:!0,userInput:l,onUserInputChange:u,onSendMessage:c,messages:h,isLoading:d,createTask:p})]})},Cc=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Promise.resolve().then(()=>ct).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Hr extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Ac extends Hr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Pc extends Hr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Rc extends Hr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Gr;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Gr||(Gr={}));var $c=function(n,e,t,r){function s(o){return o instanceof t?o:new t(function(i){i(o)})}return new(t||(t=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(h){i(h)}}function l(c){try{u(r.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class jc{constructor(e,{headers:t={},customFetch:r,region:s=Gr.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=Cc(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return $c(this,void 0,void 0,function*(){try{const{headers:s,method:o,body:i}=t;let a={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let u;i&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(a["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(a["Content-Type"]="application/json",u=JSON.stringify(i)));const c=yield this.fetch(`${this.url}/${e}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:u}).catch(y=>{throw new Ac(y)}),h=c.headers.get("x-relay-error");if(h&&h==="true")throw new Pc(c);if(!c.ok)throw new Rc(c);let d=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),p;return d==="application/json"?p=yield c.json():d==="application/octet-stream"?p=yield c.blob():d==="text/event-stream"?p=c:d==="multipart/form-data"?p=yield c.formData():p=yield c.text(),{data:p,error:null}}catch(s){return{data:null,error:s}}})}}var pe={},Jr={},er={},St={},tr={},rr={},Oc=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},lt=Oc();const Ic=lt.fetch,uo=lt.fetch.bind(lt),ho=lt.Headers,Lc=lt.Request,Dc=lt.Response,ct=Object.freeze(Object.defineProperty({__proto__:null,Headers:ho,Request:Lc,Response:Dc,default:uo,fetch:Ic},Symbol.toStringTag,{value:"Module"})),Nc=bi(ct);var nr={};Object.defineProperty(nr,"__esModule",{value:!0});let Mc=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};nr.default=Mc;var fo=ke&&ke.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(rr,"__esModule",{value:!0});const Uc=fo(Nc),Fc=fo(nr);let zc=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Uc.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var i,a,l;let u=null,c=null,h=null,d=o.status,p=o.statusText;if(o.ok){if(this.method!=="HEAD"){const S=await o.text();S===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=S:c=JSON.parse(S))}const m=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),w=(a=o.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");m&&w&&w.length>1&&(h=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,p="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const m=await o.text();try{u=JSON.parse(m),Array.isArray(u)&&o.status===404&&(c=[],u=null,d=200,p="OK")}catch{o.status===404&&m===""?(d=204,p="No Content"):u={message:m}}if(u&&this.isMaybeSingle&&(!((l=u==null?void 0:u.details)===null||l===void 0)&&l.includes("0 rows"))&&(u=null,d=200,p="OK"),u&&this.shouldThrowOnError)throw new Fc.default(u)}return{error:u,data:c,count:h,status:d,statusText:p}});return this.shouldThrowOnError||(s=s.catch(o=>{var i,a,l;return{error:{message:`${(i=o==null?void 0:o.name)!==null&&i!==void 0?i:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(a=o==null?void 0:o.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=o==null?void 0:o.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}};rr.default=zc;var Bc=ke&&ke.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(tr,"__esModule",{value:!0});const Wc=Bc(rr);let qc=class extends Wc.default{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:o=s}={}){const i=o?`${o}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const o=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(o,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:o=!1,format:i="text"}={}){var a;const l=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,o?"wal":null].filter(Boolean).join("|"),u=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${u}"; options=${l};`,i==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};tr.default=qc;var Vc=ke&&ke.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(St,"__esModule",{value:!0});const Hc=Vc(tr);let Gc=class extends Hc.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let o="";s==="plain"?o="pl":s==="phrase"?o="ph":s==="websearch"&&(o="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${o}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};St.default=Gc;var Jc=ke&&ke.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(er,"__esModule",{value:!0});const Et=Jc(St);let Kc=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=t,this.schema=r,this.fetch=s}select(e,{head:t=!1,count:r}={}){const s=t?"HEAD":"GET";let o=!1;const i=(e??"*").split("").map(a=>/\s/.test(a)&&!o?"":(a==='"'&&(o=!o),a)).join("");return this.url.searchParams.set("select",i),r&&(this.headers.Prefer=`count=${r}`),new Et.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const s="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),t&&o.push(`count=${t}`),r||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const i=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(i.length>0){const a=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new Et.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:o=!0}={}){const i="POST",a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),o||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(l.length>0){const u=[...new Set(l)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Et.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new Et.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Et.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};er.default=Kc;var sr={},or={};Object.defineProperty(or,"__esModule",{value:!0}),or.version=void 0,or.version="0.0.0-automated",Object.defineProperty(sr,"__esModule",{value:!0}),sr.DEFAULT_HEADERS=void 0;const Yc=or;sr.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Yc.version}`};var po=ke&&ke.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Jr,"__esModule",{value:!0});const Xc=po(er),Zc=po(St),Qc=sr;let eu=class gi{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},Qc.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=s}from(e){const t=new URL(`${this.url}/${e}`);return new Xc.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new gi(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:o}={}){let i;const a=new URL(`${this.url}/rpc/${e}`);let l;r||s?(i=r?"HEAD":"GET",Object.entries(t).filter(([c,h])=>h!==void 0).map(([c,h])=>[c,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([c,h])=>{a.searchParams.append(c,h)})):(i="POST",l=t);const u=Object.assign({},this.headers);return o&&(u.Prefer=`count=${o}`),new Zc.default({method:i,url:a,headers:u,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Jr.default=eu;var ut=ke&&ke.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(pe,"__esModule",{value:!0}),pe.PostgrestError=pe.PostgrestBuilder=pe.PostgrestTransformBuilder=pe.PostgrestFilterBuilder=pe.PostgrestQueryBuilder=pe.PostgrestClient=void 0;const go=ut(Jr);pe.PostgrestClient=go.default;const mo=ut(er);pe.PostgrestQueryBuilder=mo.default;const vo=ut(St);pe.PostgrestFilterBuilder=vo.default;const bo=ut(tr);pe.PostgrestTransformBuilder=bo.default;const yo=ut(rr);pe.PostgrestBuilder=yo.default;const wo=ut(nr);pe.PostgrestError=wo.default;var tu=pe.default={PostgrestClient:go.default,PostgrestQueryBuilder:mo.default,PostgrestFilterBuilder:vo.default,PostgrestTransformBuilder:bo.default,PostgrestBuilder:yo.default,PostgrestError:wo.default};const{PostgrestClient:ru,PostgrestQueryBuilder:Oh,PostgrestFilterBuilder:Ih,PostgrestTransformBuilder:Lh,PostgrestBuilder:Dh,PostgrestError:Nh}=tu,nu={"X-Client-Info":"realtime-js/2.11.2"},su="1.0.0",_o=1e4,ou=1e3;var dt;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(dt||(dt={}));var _e;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(_e||(_e={}));var Ce;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Ce||(Ce={}));var Kr;(function(n){n.websocket="websocket"})(Kr||(Kr={}));var Ke;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Ke||(Ke={}));class iu{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),o=t.getUint8(2);let i=this.HEADER_LENGTH+2;const a=r.decode(e.slice(i,i+s));i=i+s;const l=r.decode(e.slice(i,i+o));i=i+o;const u=JSON.parse(r.decode(e.slice(i,e.byteLength)));return{ref:null,topic:a,event:l,payload:u}}}class ko{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Z;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Z||(Z={}));const xo=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((o,i)=>(o[i]=au(i,n,e,s),o),{})},au=(n,e,t,r)=>{const s=e.find(a=>a.name===n),o=s==null?void 0:s.type,i=t[n];return o&&!r.includes(o)?So(o,i):Yr(i)},So=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return du(e,t)}switch(n){case Z.bool:return lu(e);case Z.float4:case Z.float8:case Z.int2:case Z.int4:case Z.int8:case Z.numeric:case Z.oid:return cu(e);case Z.json:case Z.jsonb:return uu(e);case Z.timestamp:return hu(e);case Z.abstime:case Z.date:case Z.daterange:case Z.int4range:case Z.int8range:case Z.money:case Z.reltime:case Z.text:case Z.time:case Z.timestamptz:case Z.timetz:case Z.tsrange:case Z.tstzrange:return Yr(e);default:return Yr(e)}},Yr=n=>n,lu=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},cu=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},uu=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},du=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let o;const i=n.slice(1,t);try{o=JSON.parse("["+i+"]")}catch{o=i?i.split(","):[]}return o.map(a=>So(e,a))}return n},hu=n=>typeof n=="string"?n.replace(" ","T"):n,Eo=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Xr{constructor(e,t,r={},s=_o){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var To;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(To||(To={}));class Tt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:o,onLeave:i,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Tt.syncState(this.state,s,o,i),this.pendingDiffs.forEach(l=>{this.state=Tt.syncDiff(this.state,l,o,i)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},s=>{const{onJoin:o,onLeave:i,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Tt.syncDiff(this.state,s,o,i),a())}),this.onJoin((s,o,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:o,newPresences:i})}),this.onLeave((s,o,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:o,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const o=this.cloneDeep(e),i=this.transformState(t),a={},l={};return this.map(o,(u,c)=>{i[u]||(l[u]=c)}),this.map(i,(u,c)=>{const h=o[u];if(h){const d=c.map(w=>w.presence_ref),p=h.map(w=>w.presence_ref),y=c.filter(w=>p.indexOf(w.presence_ref)<0),m=h.filter(w=>d.indexOf(w.presence_ref)<0);y.length>0&&(a[u]=y),m.length>0&&(l[u]=m)}else a[u]=c}),this.syncDiff(o,{joins:a,leaves:l},r,s)}static syncDiff(e,t,r,s){const{joins:o,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(o,(a,l)=>{var u;const c=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),c.length>0){const h=e[a].map(p=>p.presence_ref),d=c.filter(p=>h.indexOf(p.presence_ref)<0);e[a].unshift(...d)}r(a,c,l)}),this.map(i,(a,l)=>{let u=e[a];if(!u)return;const c=l.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[a]=u,s(a,u,l),u.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Co;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Co||(Co={}));var Ao;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Ao||(Ao={}));var Le;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Le||(Le={}));class Zr{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=_e.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Xr(this,Ce.join,this.params,this.timeout),this.rejoinTimer=new ko(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=_e.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=_e.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=_e.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=_e.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ce.reply,{},(s,o)=>{this._trigger(this._replyEventName(o),s)}),this.presence=new Tt(this),this.broadcastEndpointURL=Eo(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:o,presence:i,private:a}}=this.params;this._onError(c=>e==null?void 0:e(Le.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(Le.CLOSED));const l={},u={broadcast:o,presence:i,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&s!==void 0?s:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:c})=>{var h;if(this.socket.setAuth(),c===void 0){e==null||e(Le.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,p=(h=d==null?void 0:d.length)!==null&&h!==void 0?h:0,y=[];for(let m=0;m<p;m++){const w=d[m],{filter:{event:S,schema:b,table:k,filter:x}}=w,T=c&&c[m];if(T&&T.event===S&&T.schema===b&&T.table===k&&T.filter===x)y.push(Object.assign(Object.assign({},w),{id:T.id}));else{this.unsubscribe(),e==null||e(Le.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(Le.SUBSCRIBED);return}}).receive("error",c=>{e==null||e(Le.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Le.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:i}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var i,a,l;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(i=this.params)===null||i===void 0?void 0:i.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&o("ok"),u.receive("ok",()=>o("ok")),u.receive("error",()=>o("error")),u.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=_e.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ce.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const s=new Xr(this,Ce.leave,{},e);s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){const s=new AbortController,o=setTimeout(()=>s.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(o),i}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Xr(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,o;const i=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:c}=Ce;if(r&&[a,l,u,c].indexOf(i)>=0&&r!==this._joinRef())return;let d=this._onMessage(i,t,r);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var y,m,w;return((y=p.filter)===null||y===void 0?void 0:y.event)==="*"||((w=(m=p.filter)===null||m===void 0?void 0:m.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===i}).map(p=>p.callback(d,r)):(o=this.bindings[i])===null||o===void 0||o.filter(p=>{var y,m,w,S,b,k;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const x=p.id,T=(y=p.filter)===null||y===void 0?void 0:y.event;return x&&((m=t.ids)===null||m===void 0?void 0:m.includes(x))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((w=t.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const x=(b=(S=p==null?void 0:p.filter)===null||S===void 0?void 0:S.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return x==="*"||x===((k=t==null?void 0:t.event)===null||k===void 0?void 0:k.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof d=="object"&&"ids"in d){const y=d.data,{schema:m,table:w,commit_timestamp:S,type:b,errors:k}=y;d=Object.assign(Object.assign({},{schema:m,table:w,commit_timestamp:S,eventType:b,new:{},old:{},errors:k}),this._getPayloadRecords(y))}p.callback(d,r)})}_isClosed(){return this.state===_e.closed}_isJoined(){return this.state===_e.joined}_isJoining(){return this.state===_e.joining}_isLeaving(){return this.state===_e.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),o={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var o;return!(((o=s.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===r&&Zr.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ce.close,{},e)}_onError(e){this._on(Ce.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=_e.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=xo(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=xo(e.columns,e.old_record)),t}}const fu=()=>{},pu=typeof WebSocket<"u",gu=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class mu{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=nu,this.params={},this.timeout=_o,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=fu,this.conn=null,this.sendBuffer=[],this.serializer=new iu,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=o=>{let i;return o?i=o:typeof fetch>"u"?i=(...a)=>Promise.resolve().then(()=>ct).then(({default:l})=>l(...a)):i=fetch,(...a)=>i(...a)},this.endPoint=`${e}/${Kr.websocket}`,this.httpEndpoint=Eo(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(o,i)=>i(JSON.stringify(o)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ko(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(pu){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new vu(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Promise.resolve().then(()=>Zd).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:su}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case dt.connecting:return Ke.Connecting;case dt.open:return Ke.Open;case dt.closing:return Ke.Closing;default:return Ke.Closed}}isConnected(){return this.connectionState()===Ke.Open}channel(e,t={config:{}}){const r=new Zr(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:s,ref:o}=e,i=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${r} (${o})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let r=null;try{r=JSON.parse(atob(t.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=t,this.channels.forEach(s=>{t&&s.updateJoinPayload({access_token:t}),s.joinedOnce&&s._isJoined()&&s._push(Ce.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(ou,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:o,ref:i}=t;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${o.status||""} ${r} ${s} ${i&&"("+i+")"||""}`,o),this.channels.filter(a=>a._isMember(r)).forEach(a=>a._trigger(s,o,i)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ce.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([gu],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class vu{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=dt.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class Qr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ae(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class bu extends Qr{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class en extends Qr{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var yu=function(n,e,t,r){function s(o){return o instanceof t?o:new t(function(i){i(o)})}return new(t||(t=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(h){i(h)}}function l(c){try{u(r.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Po=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Promise.resolve().then(()=>ct).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},wu=()=>yu(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Promise.resolve().then(()=>ct)).Response:Response}),tn=n=>{if(Array.isArray(n))return n.map(t=>tn(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[s]=tn(r)}),e};var Ye=function(n,e,t,r){function s(o){return o instanceof t?o:new t(function(i){i(o)})}return new(t||(t=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(h){i(h)}}function l(c){try{u(r.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const rn=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),_u=(n,e,t)=>Ye(void 0,void 0,void 0,function*(){const r=yield wu();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(s=>{e(new bu(rn(s),n.status||500))}).catch(s=>{e(new en(rn(s),s))}):e(new en(rn(n),n))}),ku=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),t))};function Ct(n,e,t,r,s,o){return Ye(this,void 0,void 0,function*(){return new Promise((i,a)=>{n(t,ku(e,r,s,o)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>_u(l,a,r))})})}function ir(n,e,t,r){return Ye(this,void 0,void 0,function*(){return Ct(n,"GET",e,t,r)})}function ze(n,e,t,r,s){return Ye(this,void 0,void 0,function*(){return Ct(n,"POST",e,r,s,t)})}function xu(n,e,t,r,s){return Ye(this,void 0,void 0,function*(){return Ct(n,"PUT",e,r,s,t)})}function Su(n,e,t,r){return Ye(this,void 0,void 0,function*(){return Ct(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function Ro(n,e,t,r,s){return Ye(this,void 0,void 0,function*(){return Ct(n,"DELETE",e,r,s,t)})}var ge=function(n,e,t,r){function s(o){return o instanceof t?o:new t(function(i){i(o)})}return new(t||(t=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(h){i(h)}}function l(c){try{u(r.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Eu={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},$o={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Tu{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Po(s)}uploadOrUpdate(e,t,r,s){return ge(this,void 0,void 0,function*(){try{let o;const i=Object.assign(Object.assign({},$o),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",i.cacheControl),l&&o.append("metadata",this.encodeMetadata(l)),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.append("cacheControl",i.cacheControl),l&&o.append("metadata",this.encodeMetadata(l))):(o=r,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(a=Object.assign(Object.assign({},a),s.headers));const u=this._removeEmptyFolders(t),c=this._getFinalPath(u),h=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:o,headers:a},i!=null&&i.duplex?{duplex:i.duplex}:{})),d=yield h.json();return h.ok?{data:{path:u,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(o){if(ae(o))return{data:null,error:o};throw o}})}upload(e,t,r){return ge(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return ge(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),i=this._getFinalPath(o),a=new URL(this.url+`/object/upload/sign/${i}`);a.searchParams.set("token",t);try{let l;const u=Object.assign({upsert:$o.upsert},s),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:c}),d=yield h.json();return h.ok?{data:{path:o,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(ae(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return ge(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const o=yield ze(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),i=new URL(this.url+o.url),a=i.searchParams.get("token");if(!a)throw new Qr("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:a},error:null}}catch(r){if(ae(r))return{data:null,error:r};throw r}})}update(e,t,r){return ge(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return ge(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(ae(s))return{data:null,error:s};throw s}})}copy(e,t,r){return ge(this,void 0,void 0,function*(){try{return{data:{path:(yield ze(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(ae(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return ge(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),o=yield ze(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(s){if(ae(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return ge(this,void 0,void 0,function*(){try{const s=yield ze(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${o}`):null})),error:null}}catch(s){if(ae(s))return{data:null,error:s};throw s}})}download(e,t){return ge(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=o?`?${o}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield ir(this.fetch,`${this.url}/${s}/${a}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(ae(a))return{data:null,error:a};throw a}})}info(e){return ge(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield ir(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:tn(r),error:null}}catch(r){if(ae(r))return{data:null,error:r};throw r}})}exists(e){return ge(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Su(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(ae(r)&&r instanceof en){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],o=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";o!==""&&s.push(o);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${u}`)}}}remove(e){return ge(this,void 0,void 0,function*(){try{return{data:yield Ro(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ae(t))return{data:null,error:t};throw t}})}list(e,t,r){return ge(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Eu),t),{prefix:e||""});return{data:yield ze(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(ae(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Cu={"X-Client-Info":"storage-js/2.7.1"};var ht=function(n,e,t,r){function s(o){return o instanceof t?o:new t(function(i){i(o)})}return new(t||(t=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(h){i(h)}}function l(c){try{u(r.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Au{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},Cu),t),this.fetch=Po(r)}listBuckets(){return ht(this,void 0,void 0,function*(){try{return{data:yield ir(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ae(e))return{data:null,error:e};throw e}})}getBucket(e){return ht(this,void 0,void 0,function*(){try{return{data:yield ir(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ae(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return ht(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ae(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return ht(this,void 0,void 0,function*(){try{return{data:yield xu(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ae(r))return{data:null,error:r};throw r}})}emptyBucket(e){return ht(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ae(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ht(this,void 0,void 0,function*(){try{return{data:yield Ro(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ae(t))return{data:null,error:t};throw t}})}}class Pu extends Au{constructor(e,t={},r){super(e,t,r)}from(e){return new Tu(this.url,this.headers,e,this.fetch)}}const Ru="2.49.4";let At="";typeof Deno<"u"?At="deno":typeof document<"u"?At="web":typeof navigator<"u"&&navigator.product==="ReactNative"?At="react-native":At="node";const $u={headers:{"X-Client-Info":`supabase-js-${At}/${Ru}`}},ju={schema:"public"},Ou={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Iu={};var Lu=function(n,e,t,r){function s(o){return o instanceof t?o:new t(function(i){i(o)})}return new(t||(t=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(h){i(h)}}function l(c){try{u(r.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};const Du=n=>{let e;return n?e=n:typeof fetch>"u"?e=uo:e=fetch,(...t)=>e(...t)},Nu=()=>typeof Headers>"u"?ho:Headers,Mu=(n,e,t)=>{const r=Du(t),s=Nu();return(o,i)=>Lu(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:n;let u=new s(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",n),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),r(o,Object.assign(Object.assign({},i),{headers:u}))})};var Uu=function(n,e,t,r){function s(o){return o instanceof t?o:new t(function(i){i(o)})}return new(t||(t=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(h){i(h)}}function l(c){try{u(r.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};function Fu(n){return n.replace(/\/$/,"")}function zu(n,e){const{db:t,auth:r,realtime:s,global:o}=n,{db:i,auth:a,realtime:l,global:u}=e,c={db:Object.assign(Object.assign({},i),t),auth:Object.assign(Object.assign({},a),r),realtime:Object.assign(Object.assign({},l),s),global:Object.assign(Object.assign({},u),o),accessToken:()=>Uu(this,void 0,void 0,function*(){return""})};return n.accessToken?c.accessToken=n.accessToken:delete c.accessToken,c}const jo="2.69.1",ft=30*1e3,nn=3,sn=nn*ft,Bu="http://localhost:9999",Wu="supabase.auth.token",qu={"X-Client-Info":`gotrue-js/${jo}`},on="X-Supabase-Api-Version",Oo={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Vu=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Hu=6e5;class an extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function F(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Gu extends an{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function Ju(n){return F(n)&&n.name==="AuthApiError"}class Io extends an{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Be extends an{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class We extends Be{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ku(n){return F(n)&&n.name==="AuthSessionMissingError"}class ln extends Be{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ar extends Be{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class lr extends Be{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Yu(n){return F(n)&&n.name==="AuthImplicitGrantRedirectError"}class Lo extends Be{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class cn extends Be{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function un(n){return F(n)&&n.name==="AuthRetryableFetchError"}class Do extends Be{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Pt extends Be{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const No="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Mo=` 	
\r=`.split(""),Xu=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Mo.length;e+=1)n[Mo[e].charCodeAt(0)]=-2;for(let e=0;e<No.length;e+=1)n[No[e].charCodeAt(0)]=e;return n})();function Uo(n,e,t){const r=Xu[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Fo(n){const e=[],t=i=>{e.push(String.fromCodePoint(i))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},o=i=>{ed(i,r,t)};for(let i=0;i<n.length;i+=1)Uo(n.charCodeAt(i),s,o);return e.join("")}function Zu(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function Qu(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}Zu(r,e)}}function ed(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if(!(n>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function td(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)Uo(n.charCodeAt(s),t,r);return new Uint8Array(e)}function rd(n){const e=[];return Qu(n,t=>e.push(t)),new Uint8Array(e)}function nd(n){return Math.round(Date.now()/1e3)+n}function sd(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const je=()=>typeof window<"u"&&typeof document<"u",Xe={tested:!1,writable:!1},Rt=()=>{if(!je())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Xe.tested)return Xe.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Xe.tested=!0,Xe.writable=!0}catch{Xe.tested=!0,Xe.writable=!1}return Xe.writable};function od(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,o)=>{e[o]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const zo=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Promise.resolve().then(()=>ct).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},id=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Bo=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},cr=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ur=async(n,e)=>{await n.removeItem(e)};class dr{constructor(){this.promise=new dr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}dr.promiseConstructor=Promise;function dn(n){const e=n.split(".");if(e.length!==3)throw new Pt("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!Vu.test(e[r]))throw new Pt("JWT not in base64url format");return{header:JSON.parse(Fo(e[0])),payload:JSON.parse(Fo(e[1])),signature:td(e[2]),raw:{header:e[0],payload:e[1]}}}async function ad(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function ld(n,e){return new Promise((r,s)=>{(async()=>{for(let o=0;o<1/0;o++)try{const i=await n(o);if(!e(o,null,i)){r(i);return}}catch(i){if(!e(o,i)){s(i);return}}})()})}function cd(n){return("0"+n.toString(16)).substr(-2)}function ud(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let o=0;o<56;o++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,cd).join("")}async function dd(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(o=>String.fromCharCode(o)).join("")}async function hd(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await dd(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function pt(n,e,t=!1){const r=ud();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await Bo(n,`${e}-code-verifier`,s);const o=await hd(r);return[o,r===o?"plain":"s256"]}const fd=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function pd(n){const e=n.headers.get(on);if(!e||!e.match(fd))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function gd(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function md(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var vd=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const Ze=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),bd=[502,503,504];async function Wo(n){var e;if(!id(n))throw new cn(Ze(n),0);if(bd.includes(n.status))throw new cn(Ze(n),n.status);let t;try{t=await n.json()}catch(o){throw new Io(Ze(o),o)}let r;const s=pd(n);if(s&&s.getTime()>=Oo["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Do(Ze(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new We}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((o,i)=>o&&typeof i=="string",!0))throw new Do(Ze(t),n.status,t.weak_password.reasons);throw new Gu(Ze(t),n.status||500,r)}const yd=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function W(n,e,t,r){var s;const o=Object.assign({},r==null?void 0:r.headers);o[on]||(o[on]=Oo["2024-01-01"].name),r!=null&&r.jwt&&(o.Authorization=`Bearer ${r.jwt}`);const i=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const a=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await wd(n,e,t+a,{headers:o,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function wd(n,e,t,r,s,o){const i=yd(e,r,s,o);let a;try{a=await n(t,Object.assign({},i))}catch(l){throw console.error(l),new cn(Ze(l),0)}if(a.ok||await Wo(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(l){await Wo(l)}}function qe(n){var e;let t=null;Sd(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=nd(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function qo(n){const e=qe(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Ve(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function _d(n){return{data:n,error:null}}function kd(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:o}=n,i=vd(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:o},l=Object.assign({},i);return{data:{properties:a,user:l},error:null}}function xd(n){return n}function Sd(n){return n.access_token&&n.refresh_token&&n.expires_in}var Ed=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class Td{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=zo(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await W(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(F(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await W(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ve})}catch(r){if(F(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Ed(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await W(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:kd,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(F(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await W(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ve})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,o,i,a,l;try{const u={nextPage:null,lastPage:0,total:0},c=await W(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(o=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:xd});if(c.error)throw c.error;const h=await c.json(),d=(i=c.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(l=(a=c.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(y=>{const m=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(y.split(";")[1].split("=")[1]);u[`${w}Page`]=m}),u.total=parseInt(d)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(F(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await W(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ve})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await W(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ve})}catch(r){if(F(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await W(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ve})}catch(r){if(F(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await W(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(F(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await W(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(F(t))return{data:null,error:t};throw t}}}const Cd={getItem:n=>Rt()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{Rt()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{Rt()&&globalThis.localStorage.removeItem(n)}};function Vo(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function Ad(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const gt={debug:!!(globalThis&&Rt()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ho extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Pd extends Ho{}async function Rd(n,e,t){gt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),gt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){gt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{gt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw gt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Pd(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(gt.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Ad();const $d={url:Bu,storageKey:Wu,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:qu,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Go(n,e,t){return await t()}class $t{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=$t.nextInstanceID,$t.nextInstanceID+=1,this.instanceID>0&&je()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},$d),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Td({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=zo(s.fetch),this.lock=s.lock||Go,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:je()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Rd:this.lock=Go,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Rt()?this.storage=Cd:(this.memoryStorage={},this.storage=Vo(this.memoryStorage)):(this.memoryStorage={},this.storage=Vo(this.memoryStorage)),je()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${jo}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=od(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),je()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:o}=await this._getSessionFromURL(t,r);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),Yu(o)){const l=(e=o.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:i,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return F(t)?{error:t}:{error:new Io("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const o=await W(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:qe}),{data:i,error:a}=o;if(a||!i)return{data:{user:null,session:null},error:a};const l=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(o){if(F(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var t,r,s;try{let o;if("email"in e){const{email:c,password:h,options:d}=e;let p=null,y=null;this.flowType==="pkce"&&([p,y]=await pt(this.storage,this.storageKey)),o=await W(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:c,password:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:p,code_challenge_method:y},xform:qe})}else if("phone"in e){const{phone:c,password:h,options:d}=e;o=await W(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},channel:(s=d==null?void 0:d.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:qe})}else throw new ar("You must provide either an email or phone number and a password");const{data:i,error:a}=o;if(a||!i)return{data:{user:null,session:null},error:a};const l=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(o){if(F(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let t;if("email"in e){const{email:o,password:i,options:a}=e;t=await W(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:qo})}else if("phone"in e){const{phone:o,password:i,options:a}=e;t=await W(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:qo})}else throw new ar("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new ln}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(F(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await cr(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:o,error:i}=await W(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:qe});if(await ur(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new ln}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:i})}catch(o){if(F(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:o,nonce:i}=e,a=await W(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:qe}),{data:l,error:u}=a;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new ln}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(t){if(F(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,o,i;try{if("email"in e){const{email:a,options:l}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await pt(this.storage,this.storageKey));const{error:h}=await W(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:c}=await W(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(o=l==null?void 0:l.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new ar("You must provide either an email or phone number.")}catch(a){if(F(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,r;try{let s,o;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,o=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:a}=await W(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:qe});if(a)throw a;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,u=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(F(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{let o=null,i=null;return this.flowType==="pkce"&&([o,i]=await pt(this.storage,this.storageKey)),await W(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:i}),headers:this.headers,xform:_d})}catch(o){if(F(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new We;const{error:s}=await W(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(F(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:o}=e,{error:i}=await W(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:r,type:s,options:o}=e,{data:i,error:a}=await W(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:a}}throw new ar("You must provide either an email or phone number and a type")}catch(t){if(F(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await cr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<sn:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,c)=>(!i&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,c))})}return{data:{session:e},error:null}}const{session:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await W(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ve}):await this._useSession(async t=>{var r,s,o;const{data:i,error:a}=t;if(a)throw a;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new We}:await W(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:Ve})})}catch(t){if(F(t))return Ku(t)&&(await this._removeSession(),await ur(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:o}=r;if(o)throw o;if(!s.session)throw new We;const i=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await pt(this.storage,this.storageKey));const{data:u,error:c}=await W(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:i.access_token,xform:Ve});if(c)throw c;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(r){if(F(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new We;const t=Date.now()/1e3;let r=t,s=!0,o=null;const{payload:i}=dn(e.access_token);if(i.exp&&(r=i.exp,s=r<=t),s){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};o=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;o={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(t){if(F(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:i,error:a}=t;if(a)throw a;e=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new We;const{session:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(F(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!je())throw new lr("No browser detected.");if(e.error||e.error_description||e.error_code)throw new lr(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Lo("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new lr("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Lo("No code detected.");const{data:b,error:k}=await this._exchangeCodeForSession(e.code);if(k)throw k;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:o,refresh_token:i,expires_in:a,expires_at:l,token_type:u}=e;if(!o||!a||!i||!u)throw new lr("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(a);let d=c+h;l&&(d=parseInt(l));const p=d-c;p*1e3<=ft&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const y=d-h;c-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,d,c):c-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,d,c);const{data:m,error:w}=await this._getUser(o);if(w)throw w;const S={provider_token:r,provider_refresh_token:s,access_token:o,expires_in:h,expires_at:d,refresh_token:i,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:S,redirectType:e.type},error:null}}catch(r){if(F(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await cr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:o}=t;if(o)return{error:o};const i=(r=s.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:a}=await this.admin.signOut(i,e);if(a&&!(Ju(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await ur(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=sd(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:o},error:i}=t;if(i)throw i;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await pt(this.storage,this.storageKey,!0));try{return await W(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(o){if(F(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(F(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async o=>{var i,a,l,u,c;const{data:h,error:d}=o;if(d)throw d;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await W(this.fetch,"GET",p,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(s)throw s;return je()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(F(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:o,error:i}=t;if(i)throw i;return await W(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(F(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await ld(async s=>(s>0&&await ad(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await W(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:qe})),(s,o)=>{const i=200*Math.pow(2,s);return o&&un(o)&&Date.now()+i-r<ft})}catch(r){if(this._debug(t,"error",r),F(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),je()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await cr(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const s=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<sn;if(this._debug(t,`session has${s?"":" not"} expired with margin of ${sn}s`),s){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),un(o)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new We;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new dr;const{data:o,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!o.session)throw new We;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const a={session:o.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(o){if(this._debug(s,"error",o),F(o)){const i={session:null,error:o};return un(o)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const o=[],i=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){o.push(l)}});if(await Promise.all(i),o.length>0){for(let a=0;a<o.length;a+=1)console.error(o[a]);throw o[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Bo(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await ur(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&je()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ft);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/ft);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${ft}ms, refresh threshold is ${nn} ticks`),s<=nn&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Ho)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!je()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[o,i]=await pt(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(a.toString())}if(r!=null&&r.queryParams){const o=new URLSearchParams(r.queryParams);s.push(o.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:o}=t;return o?{data:null,error:o}:await W(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(F(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:o,error:i}=t;if(i)return{data:null,error:i};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await W(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(F(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:o}=t;if(o)return{data:null,error:o};const{data:i,error:a}=await W(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:a})})}catch(t){if(F(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:o}=t;return o?{data:null,error:o}:await W(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(F(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],s=r.filter(i=>i.factor_type==="totp"&&i.status==="verified"),o=r.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:r,totp:s,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:o}=e;if(o)return{data:null,error:o};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=dn(s.access_token);let a=null;i.aal&&(a=i.aal);let l=a;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const c=i.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(i=>i.kid===e);if(r||(r=this.jwks.keys.find(i=>i.kid===e),r&&this.jwks_cached_at+Hu>Date.now()))return r;const{data:s,error:o}=await W(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;if(!s.keys||s.keys.length===0)throw new Pt("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),r=s.keys.find(i=>i.kid===e),!r)throw new Pt("No matching signing key found in JWKS");return r}async getClaims(e,t={keys:[]}){try{let r=e;if(!r){const{data:p,error:y}=await this.getSession();if(y||!p.session)return{data:null,error:y};r=p.session.access_token}const{header:s,payload:o,signature:i,raw:{header:a,payload:l}}=dn(r);if(gd(o.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(r);if(p)throw p;return{data:{claims:o,header:s,signature:i},error:null}}const u=md(s.alg),c=await this.fetchJwk(s.kid,t),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,i,rd(`${a}.${l}`)))throw new Pt("Invalid JWT signature");return{data:{claims:o,header:s,signature:i},error:null}}catch(r){if(F(r))return{data:null,error:r};throw r}}}$t.nextInstanceID=0;const jd=$t;class Od extends jd{constructor(e){super(e)}}var Id=function(n,e,t,r){function s(o){return o instanceof t?o:new t(function(i){i(o)})}return new(t||(t=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(h){i(h)}}function l(c){try{u(r.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})};class Ld{constructor(e,t,r){var s,o,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=Fu(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:ju,realtime:Iu,auth:Object.assign(Object.assign({},Ou),{storageKey:l}),global:$u},c=zu(r??{},u);this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(o=c.global.headers)!==null&&o!==void 0?o:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(h,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=c.auth)!==null&&i!==void 0?i:{},this.headers,c.global.fetch),this.fetch=Mu(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new ru(`${a}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new jc(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Pu(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Id(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:o,flowType:i,lock:a,debug:l},u,c){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Od({url:this.authUrl,headers:Object.assign(Object.assign({},h),u),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:i,lock:a,debug:l,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new mu(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const le=((n,e,t)=>new Ld(n,e,t))("https://fwchkusgryebslnjkoly.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ3Y2hrdXNncnllYnNsbmprb2x5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ5MjkyMTcsImV4cCI6MjA2MDUwNTIxN30.ZP4Qh8Lb6DWmTlawIDHNuAnkUanInBmKblCCRVa0QuY"),Dd=async n=>{var e;try{console.log("Отправка сообщения:",n);const{data:t,error:r}=await le.from("conversations").insert([{user_query:n,bot_response:""}]).select().single();if(r)return console.error("Ошибка при отправке сообщения:",r),re.error("Ошибка при отправке сообщения"),null;let s;try{s=await Promise.race([le.functions.invoke("yandex-gpt-proxy",{body:{message:n,conversationId:t.id}}),new Promise((a,l)=>setTimeout(()=>l(new Error("Превышено время ожидания от сервера")),15e3))])}catch(a){return console.error("Ошибка вызова функции:",a),re.error("Сервер не ответил вовремя, но ваше сообщение сохранено"),await le.from("conversations").update({bot_response:"Ответ не получен. Пожалуйста, повторите запрос позже."}).eq("id",t.id),{...t,bot_response:"Ответ не получен. Пожалуйста, повторите запрос позже."}}if(s.error)return console.error("Ошибка вызова функции:",s.error),re.error("Произошла ошибка при обработке запроса"),await le.from("conversations").update({bot_response:"Функция обработки сообщений временно недоступна."}).eq("id",t.id),{...t,bot_response:"Функция обработки сообщений временно недоступна."};const{data:o,error:i}=await le.from("conversations").select().eq("id",t.id).single();return i?(console.error("Ошибка при получении ответа:",i),re.error("Не удалось получить ответ"),t):(e=s==null?void 0:s.data)!=null&&e.bot_response?(console.log("Используем прямой ответ из функции:",s.data.bot_response),{...o,bot_response:s.data.bot_response}):o.bot_response?(console.log("Получен ответ:",o),o):(console.log("Пустой ответ от сервера"),await le.from("conversations").update({bot_response:"Бот не смог сформулировать ответ. Пожалуйста, попробуйте задать вопрос по-другому."}).eq("id",t.id),{...o,bot_response:"Бот не смог сформулировать ответ. Пожалуйста, попробуйте задать вопрос по-другому."})}catch(t){return console.error("Произошла ошибка:",t),re.error("Произошла ошибка при отправке сообщения"),null}},Nd=async(n=25)=>{try{const{data:e,error:t}=await le.from("conversations").select("*").order("timestamp",{ascending:!1}).limit(n);return t?(console.error("Ошибка при получении истории сообщений:",t),re.error("Не удалось загрузить историю сообщений"),[]):e.reverse()}catch(e){return console.error("Произошла ошибка при загрузке истории:",e),re.error("Произошла ошибка при загрузке истории"),[]}},Md=()=>{const[n,e]=A.useState([]),[t,r]=A.useState(!1),[s,o]=A.useState("");A.useRef(null);const i=async()=>{const b=await Nd(25);e(b)},a=()=>{s.trim()&&(l(s),o(""))},l=async b=>{if(!b.trim()||t)return;if(r(!0),u(b)){await c(b),r(!1);return}const k={user_query:b,bot_response:"",isLoading:!0};e(x=>[...x,k]);try{const x=await Dd(b);x?(e(T=>T.filter(j=>!j.isLoading).concat([x])),await d(x.bot_response,b)):e(T=>T.map(j=>j.isLoading?{...j,isLoading:!1,bot_response:"Не удалось получить ответ"}:j))}catch(x){console.error("Ошибка при обработке сообщения:",x),e(T=>T.map(j=>j.isLoading?{...j,isLoading:!1,bot_response:"Произошла ошибка"}:j))}finally{r(!1)}},u=b=>["подтверждаю","да","точно","согласен","подтвердить","отменить","отмени","удали","удалить","убери"].some(x=>b.toLowerCase().includes(x)),c=async b=>{const x=n.slice(-3).find(T=>T.bot_response&&(T.bot_response.toLowerCase().includes("вы действительно хотите отменить бронирование")||T.bot_response.toLowerCase().includes("подтвердите отмену бронирования")));if(x){const j=x.bot_response.match(/бронирование\s+(\w+\s+\w+|\w+)/i),O=j?j[1]:null;if(O&&h(b)){const N={user_query:b,bot_response:"",isLoading:!0};e($=>[...$,N]);try{const{data:$,error:B}=await le.from("bookings").select("*").ilike("guest_name",`%${O}%`).eq("status","confirmed").limit(1).single();if(B)throw new Error(`Ошибка при получении данных бронирования: ${B.message}`);$?(await S("delete",{id:$.id,guest_name:$.guest_name}),e(Q=>Q.map(D=>D.isLoading?{...D,isLoading:!1,bot_response:`✅ Бронирование для ${$.guest_name} успешно отменено!`}:D))):e(Q=>Q.map(D=>D.isLoading?{...D,isLoading:!1,bot_response:`❌ Не удалось найти активное бронирование для ${O}`}:D))}catch($){console.error("Ошибка при отмене бронирования:",$),e(B=>B.map(Q=>Q.isLoading?{...Q,isLoading:!1,bot_response:`❌ Не удалось отменить бронирование: ${$.message}`}:Q))}return!0}}return!1},h=b=>["подтверждаю","да","точно","согласен","подтвердить"].some(x=>b.toLowerCase().includes(x)),d=async(b,k)=>{const x=k.toLowerCase().includes("отмени бронь")||k.toLowerCase().includes("отменить бронь")||k.toLowerCase().includes("удали бронирование");(k.toLowerCase().includes("покажи сообщения")||k.toLowerCase().includes("покажи сообщение от")||k.toLowerCase().includes("покажи непрочитанные")||k.toLowerCase().includes("покажи переписку"))&&b.includes("сообщение")&&b.includes("найдено")&&console.log("Запрос на просмотр сообщений WhatsApp обработан в GPT"),x&&b.includes("действительно")&&console.log("Обнаружен запрос на подтверждение отмены бронирования")},p=async b=>{try{r(!0);let k=le.from("whatsapp_messages").select("*");b.guestName&&(k=k.ilike("guest_name",`%${b.guestName}%`)),b.phoneNumber&&(k=k.eq("phone_number",b.phoneNumber)),b.onlyUnread&&(k=k.eq("is_read",!1)),k=k.order("created_at",{ascending:!1}),k=k.limit(b.limit||20);const{data:x,error:T}=await k;if(T)throw new Error(`Ошибка при получении сообщений WhatsApp: ${T.message}`);if(x&&x.length>0){const j=y(x,b),O={user_query:`Показать сообщения${b.guestName?` от ${b.guestName}`:""}${b.onlyUnread?" (непрочитанные)":""}`,bot_response:j,isLoading:!1};if(e(N=>[...N,O]),b.onlyUnread){const N=x.map($=>$.id);await le.from("whatsapp_messages").update({is_read:!0}).in("id",N)}return x}else{const j={user_query:`Показать сообщения${b.guestName?` от ${b.guestName}`:""}${b.onlyUnread?" (непрочитанные)":""}`,bot_response:`📱 Сообщений${b.guestName?` от ${b.guestName}`:""}${b.onlyUnread?" (непрочитанных)":""} не найдено.`,isLoading:!1};return e(O=>[...O,j]),[]}}catch(k){console.error("Ошибка при получении сообщений WhatsApp:",k);const x={user_query:`Показать сообщения${b.guestName?` от ${b.guestName}`:""}`,bot_response:`❌ Не удалось получить сообщения: ${k.message}`,isLoading:!1};return e(T=>[...T,x]),[]}finally{r(!1)}},y=(b,k)=>{if(!b||b.length===0)return"Сообщений не найдено";let x="";k.guestName?x+=`📱 **Сообщения ${k.onlyUnread?"непрочитанные ":""}от ${k.guestName}**

`:k.onlyUnread?x+=`📱 **Непрочитанные сообщения**

`:x+=`📱 **Последние сообщения WhatsApp**

`;const T={};return b.forEach(j=>{const O=j.guest_name||j.phone_number;T[O]||(T[O]=[]),T[O].push(j)}),Object.keys(T).forEach(j=>{Object.keys(T).length>1&&(x+=`### ${j}

`),T[j].sort((N,$)=>new Date(N.created_at).getTime()-new Date($.created_at).getTime()).forEach(N=>{const $=new Date(N.created_at),B=`${$.toLocaleDateString("ru-RU")} ${$.toLocaleTimeString("ru-RU")}`,Q=N.is_incoming?"📥":"📤",D=!N.is_read&&N.is_incoming?" (Непрочитано)":"";x+=`${Q} **${B}**${D}:
${N.content}

`})}),x},m=async b=>{try{console.log("Начало создания задачи:",b),r(!0);const k={user_query:`Создай задачу: ${b.title}`,bot_response:"Создаю задачу...",isLoading:!0};e($=>[...$,k]);const{data:{session:x}}=await le.auth.getSession(),T=x==null?void 0:x.access_token;console.log("Подготовка запроса к Edge Function task-manager");const j={"Content-Type":"application/json"};T?(console.log("Добавляем токен авторизации в запрос"),j.Authorization=`Bearer ${T}`):console.log("Токен авторизации не найден, выполняем запрос анонимно");const O=await fetch("https://fwchkusgryebslnjkoly.supabase.co/functions/v1/task-manager",{method:"POST",headers:j,body:JSON.stringify({action:"create",task:{title:b.title,description:b.description,priority:b.priority||"medium",house_number:b.houseNumber||"1"}})});if(console.log("Получен ответ от Edge Function, статус:",O.status),!O.ok){const $=await O.text();throw console.error(`Ошибка при создании задачи: ${O.status}`,$),new Error(`Ошибка при создании задачи: ${O.status} - ${$}`)}const N=await O.json();console.log("Результат создания задачи:",N),e($=>$.map(B=>{var Q;return B.isLoading?{...B,isLoading:!1,bot_response:`✅ Задача "${b.title}" успешно создана!${(Q=N.task)!=null&&Q.id?` ID: ${N.task.id}`:""}${N.employee?`, назначена на: ${N.employee}`:""}`}:B}))}catch(k){console.error("Ошибка при создании задачи:",k),e(x=>x.map(T=>T.isLoading?{...T,isLoading:!1,bot_response:`❌ Не удалось создать задачу: ${k.message}`}:T))}finally{r(!1)}},w=async(b,k)=>{try{r(!0);const x={user_query:`Отправь WhatsApp на ${b}: ${k}`,bot_response:"Отправляю сообщение...",isLoading:!0};e(O=>[...O,x]);const T=await fetch("https://fwchkusgryebslnjkoly.supabase.co/functions/v1/whatsapp-sender",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:b,message:k})});if(!T.ok)throw new Error(`Ошибка при отправке WhatsApp: ${T.status}`);const j=await T.json();e(O=>O.map(N=>N.isLoading?{...N,isLoading:!1,bot_response:`✅ Сообщение WhatsApp успешно отправлено на номер ${b}`}:N))}catch(x){console.error("Ошибка при отправке WhatsApp:",x),e(T=>T.map(j=>j.isLoading?{...j,isLoading:!1,bot_response:`❌ Не удалось отправить WhatsApp: ${x.message}`}:j))}finally{r(!1)}},S=async(b,k)=>{try{r(!0);let x=b==="create"?"Создаю":b==="update"?"Обновляю":"Удаляю";const T={user_query:`${x} бронирование: ${k.guest_name||"Гость"}, даты: ${k.start_date||"не указано"} - ${k.end_date||"не указано"}`,bot_response:`${x} бронирование...`,isLoading:!0};e($=>[...$,T]);const j=await fetch("https://fwchkusgryebslnjkoly.supabase.co/functions/v1/booking-manager",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:b,booking:k,bookingId:k.id})});if(!j.ok)throw new Error(`Ошибка при работе с бронированием: ${j.status}`);const O=await j.json(),N={create:`✅ Бронирование для ${k.guest_name} успешно создано!`,update:`✅ Бронирование для ${k.guest_name} успешно обновлено!`,delete:`✅ Бронирование для ${k.guest_name} успешно отменено!`};e($=>$.map(B=>B.isLoading?{...B,isLoading:!1,bot_response:N[b]}:B))}catch(x){console.error("Ошибка при работе с бронированием:",x),e(T=>T.map(j=>j.isLoading?{...j,isLoading:!1,bot_response:`❌ Не удалось выполнить операцию с бронированием: ${x.message}`}:j))}finally{r(!1)}};return{messages:n,isLoading:t,userInput:s,setUserInput:o,loadChatHistory:i,handleSendMessage:a,handleSendMessageText:l,createTask:m,sendWhatsAppMessage:w,manageBooking:S,getWhatsAppMessages:p}},Ud=(n={})=>{const{offsetTop:e=-600,offsetLeft:t=-450,embedded:r=!1}=n,s=A.useRef(null),[o,i]=A.useState({top:0,left:0}),a=()=>{if(s.current){const l=s.current.getBoundingClientRect();if(r){const u=window.innerHeight,c=window.innerWidth;i({top:u/2-300,left:c/2-210})}else i({top:l.top+e,left:l.left+t})}};return A.useEffect(()=>(window.addEventListener("resize",a),a(),()=>window.removeEventListener("resize",a)),[r,e,t]),{triggerRef:s,dialogPosition:o,updatePosition:a}};function hr(){return hr=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},hr.apply(null,arguments)}function Fd(n){const e=new Uint8Array(n);return window.btoa(String.fromCharCode(...e))}function zd(n){const e=window.atob(n),t=e.length,r=new Uint8Array(t);for(let s=0;s<t;s++)r[s]=e.charCodeAt(s);return r.buffer}const hn=new Map;function Jo(n,e){return async t=>{const r=hn.get(n);if(r)return t.addModule(r);const s=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(s);try{return await t.addModule(o),void hn.set(n,o)}catch{URL.revokeObjectURL(o)}try{const i=`data:application/javascript;base64,${btoa(e)}`;await t.addModule(i),hn.set(n,i)}catch{throw new Error(`Failed to load the ${n} worklet module. Make sure the browser supports AudioWorklets.`)}}}const Bd=Jo("raw-audio-processor",`
const BIAS = 0x84;
const CLIP = 32635;
const encodeTable = [
  0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,
  4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
  5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
  5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
];

function encodeSample(sample) {
  let sign;
  let exponent;
  let mantissa;
  let muLawSample;
  sign = (sample >> 8) & 0x80;
  if (sign !== 0) sample = -sample;
  sample = sample + BIAS;
  if (sample > CLIP) sample = CLIP;
  exponent = encodeTable[(sample>>7) & 0xFF];
  mantissa = (sample >> (exponent+3)) & 0x0F;
  muLawSample = ~(sign | (exponent << 4) | mantissa);
  
  return muLawSample;
}

class RawAudioProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
              
    this.port.onmessage = ({ data }) => {
      switch (data.type) {
        case "setFormat":
          this.isMuted = false;
          this.buffer = []; // Initialize an empty buffer
          this.bufferSize = data.sampleRate / 4;
          this.format = data.format;

          if (globalThis.LibSampleRate && sampleRate !== data.sampleRate) {
            globalThis.LibSampleRate.create(1, sampleRate, data.sampleRate).then(resampler => {
              this.resampler = resampler;
            });
          }
          break;
        case "setMuted":
          this.isMuted = data.isMuted;
          break;
      }
    };
  }
  process(inputs) {
    if (!this.buffer) {
      return true;
    }
    
    const input = inputs[0]; // Get the first input node
    if (input.length > 0) {
      let channelData = input[0]; // Get the first channel's data

      // Resample the audio if necessary
      if (this.resampler) {
        channelData = this.resampler.full(channelData);
      }

      // Add channel data to the buffer
      this.buffer.push(...channelData);
      // Get max volume 
      let sum = 0.0;
      for (let i = 0; i < channelData.length; i++) {
        sum += channelData[i] * channelData[i];
      }
      const maxVolume = Math.sqrt(sum / channelData.length);
      // Check if buffer size has reached or exceeded the threshold
      if (this.buffer.length >= this.bufferSize) {
        const float32Array = this.isMuted 
          ? new Float32Array(this.buffer.length)
          : new Float32Array(this.buffer);

        let encodedArray = this.format === "ulaw"
          ? new Uint8Array(float32Array.length)
          : new Int16Array(float32Array.length);

        // Iterate through the Float32Array and convert each sample to PCM16
        for (let i = 0; i < float32Array.length; i++) {
          // Clamp the value to the range [-1, 1]
          let sample = Math.max(-1, Math.min(1, float32Array[i]));

          // Scale the sample to the range [-32768, 32767]
          let value = sample < 0 ? sample * 32768 : sample * 32767;
          if (this.format === "ulaw") {
            value = encodeSample(Math.round(value));
          }

          encodedArray[i] = value;
        }

        // Send the buffered data to the main script
        this.port.postMessage([encodedArray, maxVolume]);

        // Clear the buffer after sending
        this.buffer = [];
      }
    }
    return true; // Continue processing
  }
}
registerProcessor("raw-audio-processor", RawAudioProcessor);
`);function Ko(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}class fn{static async create({sampleRate:e,format:t,preferHeadphonesForIosDevices:r}){let s=null,o=null;try{const l={sampleRate:{ideal:e},echoCancellation:{ideal:!0},noiseSuppression:{ideal:!0}};if(Ko()&&r){const p=(await window.navigator.mediaDevices.enumerateDevices()).find(y=>y.kind==="audioinput"&&["airpod","headphone","earphone"].find(m=>y.label.toLowerCase().includes(m)));p&&(l.deviceId={ideal:p.deviceId})}const u=navigator.mediaDevices.getSupportedConstraints().sampleRate;s=new window.AudioContext(u?{sampleRate:e}:{});const c=s.createAnalyser();u||await s.audioWorklet.addModule("https://cdn.jsdelivr.net/npm/@alexanderolsen/libsamplerate-js@2.1.2/dist/libsamplerate.worklet.js"),await Bd(s.audioWorklet),o=await navigator.mediaDevices.getUserMedia({audio:l});const h=s.createMediaStreamSource(o),d=new AudioWorkletNode(s,"raw-audio-processor");return d.port.postMessage({type:"setFormat",format:t,sampleRate:e}),h.connect(c),c.connect(d),await s.resume(),new fn(s,c,d,o)}catch(l){var i,a;throw(i=o)==null||i.getTracks().forEach(u=>u.stop()),(a=s)==null||a.close(),l}}constructor(e,t,r,s){this.context=void 0,this.analyser=void 0,this.worklet=void 0,this.inputStream=void 0,this.context=e,this.analyser=t,this.worklet=r,this.inputStream=s}async close(){this.inputStream.getTracks().forEach(e=>e.stop()),await this.context.close()}setMuted(e){this.worklet.port.postMessage({type:"setMuted",isMuted:e})}}const Wd=Jo("audio-concat-processor",`
const decodeTable = [0,132,396,924,1980,4092,8316,16764];

export function decodeSample(muLawSample) {
  let sign;
  let exponent;
  let mantissa;
  let sample;
  muLawSample = ~muLawSample;
  sign = (muLawSample & 0x80);
  exponent = (muLawSample >> 4) & 0x07;
  mantissa = muLawSample & 0x0F;
  sample = decodeTable[exponent] + (mantissa << (exponent+3));
  if (sign !== 0) sample = -sample;

  return sample;
}

class AudioConcatProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.buffers = []; // Initialize an empty buffer
    this.cursor = 0;
    this.currentBuffer = null;
    this.wasInterrupted = false;
    this.finished = false;
    
    this.port.onmessage = ({ data }) => {
      switch (data.type) {
        case "setFormat":
          this.format = data.format;
          break;
        case "buffer":
          this.wasInterrupted = false;
          this.buffers.push(
            this.format === "ulaw"
              ? new Uint8Array(data.buffer)
              : new Int16Array(data.buffer)
          );
          break;
        case "interrupt":
          this.wasInterrupted = true;
          break;
        case "clearInterrupted":
          if (this.wasInterrupted) {
            this.wasInterrupted = false;
            this.buffers = [];
            this.currentBuffer = null;
          }
      }
    };
  }
  process(_, outputs) {
    let finished = false;
    const output = outputs[0][0];
    for (let i = 0; i < output.length; i++) {
      if (!this.currentBuffer) {
        if (this.buffers.length === 0) {
          finished = true;
          break;
        }
        this.currentBuffer = this.buffers.shift();
        this.cursor = 0;
      }

      let value = this.currentBuffer[this.cursor];
      if (this.format === "ulaw") {
        value = decodeSample(value);
      }
      output[i] = value / 32768;
      this.cursor++;

      if (this.cursor >= this.currentBuffer.length) {
        this.currentBuffer = null;
      }
    }

    if (this.finished !== finished) {
      this.finished = finished;
      this.port.postMessage({ type: "process", finished });
    }

    return true; // Continue processing
  }
}

registerProcessor("audio-concat-processor", AudioConcatProcessor);
`);class pn{static async create({sampleRate:e,format:t}){let r=null;try{r=new AudioContext({sampleRate:e});const o=r.createAnalyser(),i=r.createGain();i.connect(o),o.connect(r.destination),await Wd(r.audioWorklet);const a=new AudioWorkletNode(r,"audio-concat-processor");return a.port.postMessage({type:"setFormat",format:t}),a.connect(i),await r.resume(),new pn(r,o,i,a)}catch(o){var s;throw(s=r)==null||s.close(),o}}constructor(e,t,r,s){this.context=void 0,this.analyser=void 0,this.gain=void 0,this.worklet=void 0,this.context=e,this.analyser=t,this.gain=r,this.worklet=s}async close(){await this.context.close()}}function Yo(n){return!!n.type}class gn{static async create(e){let t=null;try{var r;const o=(r=e.origin)!=null?r:"wss://api.elevenlabs.io",i=e.signedUrl?e.signedUrl:o+"/v1/convai/conversation?agent_id="+e.agentId,a=["convai"];e.authorization&&a.push(`bearer.${e.authorization}`),t=new WebSocket(i,a);const l=await new Promise((y,m)=>{t.addEventListener("open",()=>{var w;const S={type:"conversation_initiation_client_data"};var b,k,x,T;e.overrides&&(S.conversation_config_override={agent:{prompt:(b=e.overrides.agent)==null?void 0:b.prompt,first_message:(k=e.overrides.agent)==null?void 0:k.firstMessage,language:(x=e.overrides.agent)==null?void 0:x.language},tts:{voice_id:(T=e.overrides.tts)==null?void 0:T.voiceId}}),e.customLlmExtraBody&&(S.custom_llm_extra_body=e.customLlmExtraBody),e.dynamicVariables&&(S.dynamic_variables=e.dynamicVariables),(w=t)==null||w.send(JSON.stringify(S))},{once:!0}),t.addEventListener("error",w=>{setTimeout(()=>m(w),0)}),t.addEventListener("close",m),t.addEventListener("message",w=>{const S=JSON.parse(w.data);Yo(S)&&(S.type==="conversation_initiation_metadata"?y(S.conversation_initiation_metadata_event):console.warn("First received message is not conversation metadata."))},{once:!0})}),{conversation_id:u,agent_output_audio_format:c,user_input_audio_format:h}=l,d=Xo(h??"pcm_16000"),p=Xo(c);return new gn(t,u,d,p)}catch(o){var s;throw(s=t)==null||s.close(),o}}constructor(e,t,r,s){this.socket=void 0,this.conversationId=void 0,this.inputFormat=void 0,this.outputFormat=void 0,this.queue=[],this.disconnectionDetails=null,this.onDisconnectCallback=null,this.onMessageCallback=null,this.socket=e,this.conversationId=t,this.inputFormat=r,this.outputFormat=s,this.socket.addEventListener("error",o=>{setTimeout(()=>this.disconnect({reason:"error",message:"The connection was closed due to a socket error.",context:o}),0)}),this.socket.addEventListener("close",o=>{this.disconnect(o.code===1e3?{reason:"agent",context:o}:{reason:"error",message:o.reason||"The connection was closed by the server.",context:o})}),this.socket.addEventListener("message",o=>{try{const i=JSON.parse(o.data);if(!Yo(i))return;this.onMessageCallback?this.onMessageCallback(i):this.queue.push(i)}catch{}})}close(){this.socket.close()}sendMessage(e){this.socket.send(JSON.stringify(e))}onMessage(e){this.onMessageCallback=e,this.queue.forEach(e),this.queue=[]}onDisconnect(e){this.onDisconnectCallback=e,this.disconnectionDetails&&e(this.disconnectionDetails)}disconnect(e){var t;this.disconnectionDetails||(this.disconnectionDetails=e,(t=this.onDisconnectCallback)==null||t.call(this,e))}}function Xo(n){const[e,t]=n.split("_");if(!["pcm","ulaw"].includes(e))throw new Error(`Invalid format: ${n}`);const r=parseInt(t);if(isNaN(r))throw new Error(`Invalid sample rate: ${t}`);return{format:e,sampleRate:r}}const qd={clientTools:{}},Vd={onConnect:()=>{},onDebug:()=>{},onDisconnect:()=>{},onError:()=>{},onMessage:()=>{},onAudio:()=>{},onModeChange:()=>{},onStatusChange:()=>{},onCanSendFeedbackChange:()=>{}};class mn{static async startSession(e){var t;const r=hr({},qd,Vd,e);r.onStatusChange({status:"connecting"}),r.onCanSendFeedbackChange({canSendFeedback:!1});let s=null,o=null,i=null,a=null,l=null;if((t=e.useWakeLock)==null||t)try{l=await navigator.wakeLock.request("screen")}catch{}try{var u,c;a=await navigator.mediaDevices.getUserMedia({audio:!0});const b=(u=e.connectionDelay)!=null?u:{default:0,android:3e3};let k=b.default;var h;if(/android/i.test(navigator.userAgent))k=(h=b.android)!=null?h:k;else if(Ko()){var d;k=(d=b.ios)!=null?d:k}return k>0&&await new Promise(x=>setTimeout(x,k)),o=await gn.create(e),[s,i]=await Promise.all([fn.create(hr({},o.inputFormat,{preferHeadphonesForIosDevices:e.preferHeadphonesForIosDevices})),pn.create(o.outputFormat)]),(c=a)==null||c.getTracks().forEach(x=>x.stop()),a=null,new mn(r,o,s,i,l)}catch(b){var p,y,m,w;r.onStatusChange({status:"disconnected"}),(p=a)==null||p.getTracks().forEach(k=>k.stop()),(y=o)==null||y.close(),await((m=s)==null?void 0:m.close()),await((w=i)==null?void 0:w.close());try{var S;await((S=l)==null?void 0:S.release()),l=null}catch{}throw b}}constructor(e,t,r,s,o){var i=this;this.options=void 0,this.connection=void 0,this.input=void 0,this.output=void 0,this.wakeLock=void 0,this.lastInterruptTimestamp=0,this.mode="listening",this.status="connecting",this.inputFrequencyData=void 0,this.outputFrequencyData=void 0,this.volume=1,this.currentEventId=1,this.lastFeedbackEventId=1,this.canSendFeedback=!1,this.endSession=()=>this.endSessionWithDetails({reason:"user"}),this.endSessionWithDetails=async function(a){if(i.status==="connected"||i.status==="connecting"){i.updateStatus("disconnecting");try{var l;await((l=i.wakeLock)==null?void 0:l.release()),i.wakeLock=null}catch{}i.connection.close(),await i.input.close(),await i.output.close(),i.updateStatus("disconnected"),i.options.onDisconnect(a)}},this.updateMode=a=>{a!==this.mode&&(this.mode=a,this.options.onModeChange({mode:a}))},this.updateStatus=a=>{a!==this.status&&(this.status=a,this.options.onStatusChange({status:a}))},this.updateCanSendFeedback=()=>{const a=this.currentEventId!==this.lastFeedbackEventId;this.canSendFeedback!==a&&(this.canSendFeedback=a,this.options.onCanSendFeedbackChange({canSendFeedback:a}))},this.onMessage=async function(a){switch(a.type){case"interruption":return a.interruption_event&&(i.lastInterruptTimestamp=a.interruption_event.event_id),void i.fadeOutAudio();case"agent_response":return void i.options.onMessage({source:"ai",message:a.agent_response_event.agent_response});case"user_transcript":return void i.options.onMessage({source:"user",message:a.user_transcription_event.user_transcript});case"internal_tentative_agent_response":return void i.options.onDebug({type:"tentative_agent_response",response:a.tentative_agent_response_internal_event.tentative_agent_response});case"client_tool_call":if(i.options.clientTools.hasOwnProperty(a.client_tool_call.tool_name))try{var l;const u=(l=await i.options.clientTools[a.client_tool_call.tool_name](a.client_tool_call.parameters))!=null?l:"Client tool execution successful.",c=typeof u=="object"?JSON.stringify(u):String(u);i.connection.sendMessage({type:"client_tool_result",tool_call_id:a.client_tool_call.tool_call_id,result:c,is_error:!1})}catch(u){i.onError("Client tool execution failed with following error: "+(u==null?void 0:u.message),{clientToolName:a.client_tool_call.tool_name}),i.connection.sendMessage({type:"client_tool_result",tool_call_id:a.client_tool_call.tool_call_id,result:"Client tool execution failed: "+(u==null?void 0:u.message),is_error:!0})}else{if(i.options.onUnhandledClientToolCall)return void i.options.onUnhandledClientToolCall(a.client_tool_call);i.onError(`Client tool with name ${a.client_tool_call.tool_name} is not defined on client`,{clientToolName:a.client_tool_call.tool_name}),i.connection.sendMessage({type:"client_tool_result",tool_call_id:a.client_tool_call.tool_call_id,result:`Client tool with name ${a.client_tool_call.tool_name} is not defined on client`,is_error:!0})}return;case"audio":return void(i.lastInterruptTimestamp<=a.audio_event.event_id&&(i.options.onAudio(a.audio_event.audio_base_64),i.addAudioBase64Chunk(a.audio_event.audio_base_64),i.currentEventId=a.audio_event.event_id,i.updateCanSendFeedback(),i.updateMode("speaking")));case"ping":return void i.connection.sendMessage({type:"pong",event_id:a.ping_event.event_id});default:return void i.options.onDebug(a)}},this.onInputWorkletMessage=a=>{this.status==="connected"&&this.connection.sendMessage({user_audio_chunk:Fd(a.data[0].buffer)})},this.onOutputWorkletMessage=({data:a})=>{a.type==="process"&&this.updateMode(a.finished?"listening":"speaking")},this.addAudioBase64Chunk=a=>{this.output.gain.gain.value=this.volume,this.output.worklet.port.postMessage({type:"clearInterrupted"}),this.output.worklet.port.postMessage({type:"buffer",buffer:zd(a)})},this.fadeOutAudio=()=>{this.updateMode("listening"),this.output.worklet.port.postMessage({type:"interrupt"}),this.output.gain.gain.exponentialRampToValueAtTime(1e-4,this.output.context.currentTime+2),setTimeout(()=>{this.output.gain.gain.value=this.volume,this.output.worklet.port.postMessage({type:"clearInterrupted"})},2e3)},this.onError=(a,l)=>{console.error(a,l),this.options.onError(a,l)},this.calculateVolume=a=>{if(a.length===0)return 0;let l=0;for(let u=0;u<a.length;u++)l+=a[u]/255;return l/=a.length,l<0?0:l>1?1:l},this.getId=()=>this.connection.conversationId,this.isOpen=()=>this.status==="connected",this.setVolume=({volume:a})=>{this.volume=a},this.setMicMuted=a=>{this.input.setMuted(a)},this.getInputByteFrequencyData=()=>(this.inputFrequencyData!=null||(this.inputFrequencyData=new Uint8Array(this.input.analyser.frequencyBinCount)),this.input.analyser.getByteFrequencyData(this.inputFrequencyData),this.inputFrequencyData),this.getOutputByteFrequencyData=()=>(this.outputFrequencyData!=null||(this.outputFrequencyData=new Uint8Array(this.output.analyser.frequencyBinCount)),this.output.analyser.getByteFrequencyData(this.outputFrequencyData),this.outputFrequencyData),this.getInputVolume=()=>this.calculateVolume(this.getInputByteFrequencyData()),this.getOutputVolume=()=>this.calculateVolume(this.getOutputByteFrequencyData()),this.sendFeedback=a=>{this.canSendFeedback?(this.connection.sendMessage({type:"feedback",score:a?"like":"dislike",event_id:this.currentEventId}),this.lastFeedbackEventId=this.currentEventId,this.updateCanSendFeedback()):console.warn(this.lastFeedbackEventId===0?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")},this.sendContextualUpdate=a=>{this.connection.sendMessage({type:"contextual_update",text:a})},this.sendUserMessage=a=>{this.connection.sendMessage({type:"user_message",text:a})},this.sendUserActivity=()=>{this.connection.sendMessage({type:"user_activity"})},this.options=e,this.connection=t,this.input=r,this.output=s,this.wakeLock=o,this.options.onConnect({conversationId:t.conversationId}),this.connection.onDisconnect(this.endSessionWithDetails),this.connection.onMessage(this.onMessage),this.input.worklet.port.onmessage=this.onInputWorkletMessage,this.output.worklet.port.onmessage=this.onOutputWorkletMessage,this.updateStatus("connected")}}function vn(){return vn=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},vn.apply(null,arguments)}const Hd=["micMuted","volume"];function Gd(n={}){const{micMuted:e,volume:t}=n,r=function(d,p){if(d==null)return{};var y={};for(var m in d)if({}.hasOwnProperty.call(d,m)){if(p.includes(m))continue;y[m]=d[m]}return y}(n,Hd),s=A.useRef(null),o=A.useRef(null),[i,a]=A.useState("disconnected"),[l,u]=A.useState(!1),[c,h]=A.useState("listening");return A.useEffect(()=>{var d;e!==void 0&&(s==null||(d=s.current)==null||d.setMicMuted(e))},[e]),A.useEffect(()=>{var d;t!==void 0&&(s==null||(d=s.current)==null||d.setVolume({volume:t}))},[t]),A.useEffect(()=>()=>{var d;(d=s.current)==null||d.endSession()},[]),{startSession:async d=>{var p;if((p=s.current)!=null&&p.isOpen())return s.current.getId();if(o.current)return(await o.current).getId();try{return o.current=mn.startSession(vn({},r??{},d??{},{onModeChange:({mode:y})=>{h(y)},onStatusChange:({status:y})=>{a(y)},onCanSendFeedbackChange:({canSendFeedback:y})=>{u(y)}})),s.current=await o.current,e!==void 0&&s.current.setMicMuted(e),t!==void 0&&s.current.setVolume({volume:t}),s.current.getId()}finally{o.current=null}},endSession:async()=>{const d=s.current;s.current=null,await(d==null?void 0:d.endSession())},setVolume:({volume:d})=>{var p;(p=s.current)==null||p.setVolume({volume:d})},getInputByteFrequencyData:()=>{var d;return(d=s.current)==null?void 0:d.getInputByteFrequencyData()},getOutputByteFrequencyData:()=>{var d;return(d=s.current)==null?void 0:d.getOutputByteFrequencyData()},getInputVolume:()=>{var d,p;return(d=(p=s.current)==null?void 0:p.getInputVolume())!=null?d:0},getOutputVolume:()=>{var d,p;return(d=(p=s.current)==null?void 0:p.getOutputVolume())!=null?d:0},sendFeedback:d=>{var p;(p=s.current)==null||p.sendFeedback(d)},getId:()=>{var d;return(d=s.current)==null?void 0:d.getId()},sendContextualUpdate:d=>{var p;(p=s.current)==null||p.sendContextualUpdate(d)},sendUserMessage:d=>{var p;(p=s.current)==null||p.sendUserMessage(d)},sendUserActivity:()=>{var d;(d=s.current)==null||d.sendUserActivity()},status:i,canSendFeedback:l,micMuted:e,isSpeaking:c==="speaking"}}const Jd=({embeddedMode:n=!1})=>{const[e,t]=A.useState(!1),[r,s]=A.useState(!1),[o,i]=A.useState(!1),[a,l]=A.useState(!1),[u,c]=A.useState(0),[h,d]=A.useState("");A.useRef(!1);const p=_=>{let E=_.replace(/\D/g,"");return E.startsWith("8")&&E.length===11&&(E="7"+E.substring(1)),E.length===10&&(E="7"+E),console.log(`Отформатированный номер телефона: ${E}`),E},y=async(_,E)=>{try{let L="";const{data:G}=await le.from("bookings").select("guest_name").eq("guest_phone",_).order("created_at",{ascending:!1}).limit(1);G&&G.length>0&&(L=G[0].guest_name);let z=`Здравствуйте${L?", "+L:""}!`;return E?E.toLowerCase().includes("музык")?z+=" Пожалуйста, выключите музыку. Спасибо за понимание.":E.toLowerCase().includes("шум")?z+=" Пожалуйста, соблюдайте тишину. Спасибо за понимание.":E.toLowerCase().includes("уборк")?z+=" Сообщаем, что скоро будет проведена уборка в вашем номере.":E.toLowerCase().includes("выезд")||E.toLowerCase().includes("выселени")?z+=" Напоминаем о выезде до 12:00. Если нужно продлить проживание, сообщите администратору.":z+=" Как мы можем вам помочь?":z+=" Как мы можем вам помочь?",z}catch(L){return console.error("Ошибка при генерации текста сообщения:",L),"Здравствуйте! Как мы можем вам помочь?"}},{triggerRef:m,dialogPosition:w}=Ud({offsetTop:-600,offsetLeft:-450,embedded:n}),{messages:S,isLoading:b,userInput:k,setUserInput:x,loadChatHistory:T,handleSendMessage:j,handleSendMessageText:O,sendWhatsAppMessage:N,createTask:$,manageBooking:B,getWhatsAppMessages:Q}=Md(),D=Gd({onConnect:()=>{console.log("Используется Agent ID:",process.env.NEXT_PUBLIC_AGENT_ID||"bk6zd2EX7Rc7o9LnxEtY"),console.log("ElevenLabs conversation connected"),i(!0),re.success("Голосовой ассистент активирован")},onDisconnect:()=>{console.log("ElevenLabs conversation disconnected"),i(!1),l(!1)},onMessage:_=>{var E,L;_.type==="transcription"&&((E=_.transcription)!=null&&E.is_final)?(console.log("Распознанная речь:",_.transcription.text),d(_.transcription.text)):_.type==="generation"&&((L=_.generation)!=null&&L.text)?(console.log("Ответ ассистента:",_.generation.text),l(!0)):_.type==="debug"&&console.log("ElevenLabs debug message:",_.debug)},onError:_=>{console.error("Ошибка ElevenLabs:",_),re.error(`Ошибка голосового ассистента: ${_.message||"Неизвестная ошибка"}`),i(!1),l(!1)},clientTools:{createTask:async _=>{if(!$)return console.error("createTask function is not available"),"Error: Task creation function is not available";try{return await $({title:_.title,description:_.description,priority:_.priority,houseNumber:_.houseNumber}),"Задача успешно создана"}catch(E){return console.error("Error creating task:",E),`Ошибка при создании задачи: ${E.message}`}},getBookings:async _=>{try{console.log("Вызван метод getBookings с параметрами:",_);let E=le.from("bookings").select("*");_.guestName&&(E=E.ilike("guest_name",`%${_.guestName}%`)),_.status&&(E=E.eq("status",_.status)),_.startDate&&(E=E.gte("start_date",_.startDate)),_.endDate&&(E=E.lte("end_date",_.endDate)),E=E.order("created_at",{ascending:!1}).limit(_.limit||10);const{data:L,error:G}=await E;if(G)throw console.error("Ошибка при получении данных бронирований:",G),G;return console.log(`Найдено ${(L==null?void 0:L.length)||0} бронирований`),{success:!0,data:L||[],message:`Найдено ${(L==null?void 0:L.length)||0} бронирований`}}catch(E){return console.error("Ошибка при получении бронирований:",E),{success:!1,data:[],message:`Ошибка при получении бронирований: ${E.message||"Неизвестная ошибка"}`}}},getWhatsAppMessages:async _=>{try{console.log("Вызван метод getWhatsAppMessages с параметрами:",_);let E=le.from("whatsapp_messages").select("*");if(_.phone){const z=_.phone.replace(/\D/g,"");z.length>0&&(E=E.ilike("phone_number",`%${z}%`))}_.guestName&&(E=E.ilike("guest_name",`%${_.guestName}%`)),_.showUnread&&(E=E.eq("is_read",!1)),_.startDate&&(E=E.gte("created_at",_.startDate)),_.endDate&&(E=E.lte("created_at",_.endDate)),E=E.order("created_at",{ascending:!1}).limit(_.limit||10);const{data:L,error:G}=await E;if(G)throw console.error("Ошибка при получении сообщений WhatsApp:",G),G;return console.log(`Найдено ${(L==null?void 0:L.length)||0} сообщений WhatsApp`),{success:!0,data:L||[],message:`Найдено ${(L==null?void 0:L.length)||0} сообщений WhatsApp`}}catch(E){return console.error("Ошибка при получении сообщений WhatsApp:",E),{success:!1,data:[],message:`Ошибка при получении сообщений WhatsApp: ${E.message||"Неизвестная ошибка"}`}}},getTasks:async _=>{try{console.log("Вызван метод getTasks с параметрами:",_);let E=le.from("tasks").select(`
              *,
              employees (
                name,
                position
              )
            `);_.status&&(E=E.eq("status",_.status)),_.priority&&(E=E.eq("priority",_.priority)),_.houseNumber&&(E=E.eq("house_number",_.houseNumber)),_.startDate&&(E=E.gte("created_at",_.startDate)),_.endDate&&(E=E.lte("created_at",_.endDate)),E=E.order("created_at",{ascending:!1}).limit(_.limit||10);const{data:L,error:G}=await E;if(G)throw console.error("Ошибка при получении задач:",G),G;let z=L||[];return _.employeeName&&z.length>0&&(z=z.filter(ne=>{var oe,jt;return(jt=ne.employees)==null?void 0:jt.name.toLowerCase().includes(((oe=_.employeeName)==null?void 0:oe.toLowerCase())||"")})),console.log(`Найдено ${z.length} задач`),{success:!0,data:z,message:`Найдено ${z.length} задач`}}catch(E){return console.error("Ошибка при получении задач:",E),{success:!1,data:[],message:`Ошибка при получении задач: ${E.message||"Неизвестная ошибка"}`}}},cancelBooking:async _=>{try{if(console.log("Вызван метод cancelBooking с параметрами:",_),!_.id&&!_.guestName)throw new Error("Необходимо указать ID бронирования или имя гостя");let E=le.from("bookings").select("*");_.id?E=E.eq("id",_.id):_.guestName&&(E=E.ilike("guest_name",`%${_.guestName}%`));const{data:L,error:G}=await E.order("created_at",{ascending:!1}).limit(1);if(G)throw console.error("Ошибка при поиске бронирования:",G),G;if(!L||L.length===0)return console.log("Бронирование не найдено"),{success:!1,message:"Бронирование не найдено"};console.log("Найдено бронирование для отмены:",L[0]);const{data:z,error:ne}=await le.from("bookings").update({status:"cancelled"}).eq("id",L[0].id).select();if(ne)throw console.error("Ошибка при отмене бронирования:",ne),ne;return console.log("Бронирование успешно отменено:",z),{success:!0,data:L[0],message:`Бронирование для ${L[0].guest_name} успешно отменено`}}catch(E){return console.error("Ошибка при отмене бронирования:",E),{success:!1,message:`Ошибка при отмене бронирования: ${E.message||"Неизвестная ошибка"}`}}},createBooking:async _=>{try{if(console.log("Вызван метод createBooking с параметрами:",_),!_.room_number||!_.guest_name||!_.guest_phone||!_.start_date||!_.end_date){const oe="Для создания бронирования необходимы: номер комнаты, имя гостя, телефон, даты заезда и выезда";return console.error(oe),re.error(oe),{success:!1,message:oe}}const E=p(_.guest_phone),L=await fetch("https://fwchkusgryebslnjkoly.supabase.co/functions/v1/booking-manager",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"check-availability",booking:{room_number:_.room_number,start_date:_.start_date,end_date:_.end_date}})});if(!L.ok){const oe=await L.text();throw re.error(`Ошибка при проверке доступности: ${L.status}`),new Error(`Ошибка при проверке доступности: ${oe}`)}if(!(await L.json()).available){const oe=`Номер ${_.room_number} недоступен на указанные даты`;return re.error(oe),{success:!1,message:oe}}const z=await fetch("https://fwchkusgryebslnjkoly.supabase.co/functions/v1/booking-manager",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"create",booking:{room_number:_.room_number,start_date:_.start_date,end_date:_.end_date,guest_name:_.guest_name,guest_phone:E,price:_.price||null,prepayment:_.prepayment||0,comment:_.comment||"",source:"elevenlabs"}})});if(!z.ok){const oe=await z.text();throw re.error(`Ошибка при создании бронирования: ${z.status}`),new Error(`Ошибка API бронирования: ${z.status} - ${oe}`)}const ne=await z.json();if(console.log("Результат создания бронирования:",ne),ne.success){re.success(`Бронирование для ${_.guest_name} успешно создано!`);try{const oe=`Здравствуйте, ${_.guest_name}! Ваше бронирование номера ${_.room_number} на даты ${_.start_date} - ${_.end_date} успешно создано. Спасибо, что выбрали наш отель!`;await N(E,oe)}catch(oe){console.error("Ошибка при отправке уведомления:",oe)}}return{success:!0,booking:ne.booking,message:`Бронирование для ${_.guest_name} успешно создано!`}}catch(E){return console.error("Ошибка при создании бронирования:",E),re.error(`Ошибка при создании бронирования: ${E.message||"Неизвестная ошибка"}`),{success:!1,message:`Ошибка при создании бронирования: ${E.message||"Неизвестная ошибка"}`}}},sendWhatsAppMessage:async _=>{try{if(console.log("Вызван метод sendWhatsAppMessage с параметрами:",_),!_.phone){const z="Номер телефона обязателен для заполнения";return console.error(z),re.error(z),{success:!1,message:z}}const E=p(_.phone);if(console.log("Номер после форматирования:",E),E.length<10){const z="Некорректный формат номера телефона";return console.error(z,{original:_.phone,cleaned:E}),re.error(z),{success:!1,message:z,details:{original:_.phone,cleaned:E}}}let L=_.message;return L||(console.log("Сообщение не указано, генерируем автоматически"),L=await y(E,_.context),console.log("Сгенерированное сообщение:",L)),await N(E,L)}catch(E){return console.error("Ошибка при отправке WhatsApp сообщения:",E),re.error(`Ошибка при отправке сообщения: ${E.message||"Неизвестная ошибка"}`),{success:!1,message:`Ошибка при отправке сообщения: ${E.message||"Неизвестная ошибка"}`}}}}});A.useEffect(()=>{l(D.isSpeaking)},[D.isSpeaking]),A.useEffect(()=>{if(D.isSpeaking){const _=setInterval(()=>{c(Math.floor(Math.random()*7)+3)},150);return()=>clearInterval(_)}else c(0)},[D.isSpeaking]);const ce=async()=>{try{if(D.status==="connected")console.log("Ending ElevenLabs conversation"),await D.endSession(),i(!1),l(!1),re.info("Голосовой ассистент деактивирован");else{console.log("Starting ElevenLabs conversation");const _=process.env.NEXT_PUBLIC_AGENT_ID||"bk6zd2EX7Rc7o9LnxEtY";console.log("Используется Agent ID:",_),await D.startSession({agentId:_}),re.success("Голосовой ассистент активирован")}}catch(_){console.error("Error toggling ElevenLabs conversation:",_),re.error(`Ошибка активации ассистента: ${_.message||"Неизвестная ошибка"}`)}};A.useEffect(()=>{e&&T()},[e,T]),A.useEffect(()=>{if(n){const _=setTimeout(()=>{t(!0),T()},500);return()=>clearTimeout(_)}},[n,T]);const me=_=>{t(_),_?_&&n&&setTimeout(()=>{!o&&D.status!=="connected"&&ce()},1e3):(s(!1),D.status==="connected"&&D.endSession())},Oe=()=>{s(!r)};return v.jsxs(v.Fragment,{children:[v.jsxs(Nl,{open:e,onOpenChange:me,children:[n?null:v.jsx(Ml,{asChild:!0,children:v.jsx(Ns,{ref:m})}),v.jsx(Tc,{isExpanded:r,toggleFullscreen:Oe,dialogPosition:w,isListening:o,isSpeaking:a,voiceVolume:u,transcript:h,onCircleClick:ce,userInput:k,onUserInputChange:_=>x(_.target.value),onSendMessage:j,messages:S,isLoading:b,createTask:$})]}),n&&v.jsx("div",{style:{position:"fixed",bottom:"-100px",right:"-100px",visibility:"hidden"},children:v.jsx("button",{ref:m,children:"Hidden Trigger"})})]})};class Kd extends HTMLElement{constructor(){super();K(this,"shadow");K(this,"container");K(this,"root",null);this.shadow=this.attachShadow({mode:"open"}),this.container=document.createElement("div"),this.container.setAttribute("class","voice-assistant-container"),this.shadow.appendChild(this.container);const t=document.createElement("style");t.textContent=`
      .voice-assistant-container {
        position: relative;
        z-index: 9999;
      }
      
      /* Import fonts and base styles */
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    `,this.shadow.appendChild(t)}connectedCallback(){const t=this.getAttribute("agent-id")||"bk6zd2EX7Rc7o9LnxEtY",r=document.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("href","https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"),this.shadow.appendChild(r);const s=document.createElement("link");s.setAttribute("rel","stylesheet"),s.setAttribute("href","https://elevenlabs.io/convai-widget/styles.css"),this.shadow.appendChild(s),window.env={...window.env,NEXT_PUBLIC_AGENT_ID:t};try{this.root=yr(this.container),this.root.render(v.jsx(A.StrictMode,{children:v.jsx(Jd,{embeddedMode:!0})}))}catch(o){console.error("Error rendering voice assistant:",o)}}disconnectedCallback(){this.root&&(this.root.unmount(),this.root=null)}}customElements.define("voice-assistant",Kd),console.log("Voice Assistant Widget initialized");const Yd="voice-assistant";var Xd=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")};const Zd=Object.freeze(Object.defineProperty({__proto__:null,default:vi(Xd)},Symbol.toStringTag,{value:"Module"}));return Yd});
//# sourceMappingURL=voice-assistant-widget.umd.js.map
